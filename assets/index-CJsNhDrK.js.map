{"version":3,"file":"index-CJsNhDrK.js","sources":["../../src/constant.ts","../../src/app/app.ts","../../src/utils/date/dateUtils.ts","../../node_modules/nanoid/url-alphabet/index.js","../../node_modules/nanoid/index.browser.js","../../node_modules/idb/build/index.js","../../src/utils/db/db.ts","../../src/utils/db/balanceDB.ts","../../src/utils/db/transactionDB.ts","../../src/app/appStore.ts","../../src/app/route.ts","../../src/app/screen-adapters.ts","../../src/events/events.ts","../../src/models/account/account.ts","../../src/models/balance/balance.ts","../../src/models/transaction/transaction.ts","../../src/utils/formatters/dateFormatter.ts","../../src/components/selector/selecor.ts","../../src/components/calendar/calendar.ts","../../src/assets/next.svg","../../src/assets/prev-disabled.svg","../../src/assets/prev.svg","../../src/components/calendar/dateSelector.ts","../../src/utils/formatters/inputFormatter.ts","../../src/presenters/balancePresenter.ts","../../src/presenters/dayLimitPresenter.ts","../../src/presenters/transactionPresenter.ts","../../src/presenters/welcomePagePresenter.ts","../../src/views/mainView.ts","../../src/main.ts"],"sourcesContent":["export const BASE_URL = import.meta.env.BASE_URL;\n\nexport const balanceDBVersion = 1 as const;\nexport const balanceDBName = 'balanceDB' as const;\nexport const balanceTableName = 'balance' as const;\n\nexport const transactionDBVersion = 1 as const;\nexport const transactionDBName = 'transactionDB' as const;\nexport const transactionTableName = 'transaction' as const;\n\nexport const SYSTEM_NAME_SPACE = {\n    WELCOME_PAGE: 'WELCOME_PAGE',\n    MAIN_PAGE: 'MAIN_PAGE',\n    BALANCE_PAGE: 'BALANCE_PAGE',\n    TRANSACTION_PAGE: 'TRANSACTION_PAGE',\n    HISTORY_TRANSACTION_PAGE: 'HISTORY_TRANSACTION_PAGE',\n    BALANCE_BLOCK: 'BALANCE_BLOCK',\n    DAY_LIMIT_BLOCK: 'DAY_LIMIT_BLOCK',\n    TRANSACTION_BLOCK: 'TRANSACTION_BLOCK',\n} as const;\n\nexport const SYSTEM_EVENTS = {\n    CHANGE_PAGE: 'CHANGE_PAGE',\n    INIT_BALANCE: 'INIT_BALANCE',\n    BALANCE_UPDATED: 'BALANCE_UPDATED',\n    TRANSACTION_UPDATED: 'TRANSACTION_UPDATED',\n} as const;\n\nexport const LS_NAME_SPACE = {\n    INIT_BALANCE: 'INIT_BALANCE',\n    BALANCE: 'BALANCE',\n} as const;\n","import { SYSTEM_EVENTS, SYSTEM_NAME_SPACE } from '../constant.ts';\nimport { IEvents } from '../events/events.ts';\n\nimport { IApp, IAppStore, IRouter } from './types.ts';\n\nexport class App implements IApp {\n    constructor(\n        private readonly store: IAppStore,\n        private readonly router: IRouter,\n        private readonly events: IEvents\n    ) {}\n\n    /**\n     * Точка входа: готовим данные и показываем стартовый экран\n     */\n    public async start(): Promise<void> {\n        this.bindEvents();\n\n        await this.store.init();\n\n        await this.router.go(\n            this.store.isWelcomeCompleted() ? SYSTEM_NAME_SPACE.MAIN_PAGE : SYSTEM_NAME_SPACE.WELCOME_PAGE\n        );\n    }\n\n    public destroy(): void {\n        this.router.destroy();\n    }\n\n    private bindEvents(): void {\n        this.events.on(SYSTEM_EVENTS.INIT_BALANCE, async () => {\n            await this.router.go(SYSTEM_NAME_SPACE.MAIN_PAGE);\n        });\n\n        this.events.on(SYSTEM_EVENTS.CHANGE_PAGE, async (obj: { page: string }) => {\n            if (typeof obj.page !== 'string') {\n                return;\n            }\n\n            await this.router.go(obj.page);\n        });\n    }\n}\n","/**\n * Возвращает дату \"сегодня\" в 00:00:00.000\n */\nexport function getCurrentDate(): Date {\n    const d = new Date();\n    d.setHours(0, 0, 0, 0);\n    return d;\n}\n\n/**\n * Завтрашний день (00:00).\n */\nexport function getNextDay(): Date {\n    const today = getCurrentDate();\n    today.setDate(today.getDate() + 1);\n    return today;\n}\n\n/**\n * Дата через неделю (00:00).\n */\nexport function getNextWeek(): Date {\n    const today = getCurrentDate();\n    today.setDate(today.getDate() + 7);\n    return today;\n}\n\n/**\n * Дата через две недели (00:00).\n */\nexport function getNextTwoWeek(): Date {\n    const today = getCurrentDate();\n    today.setDate(today.getDate() + 14);\n    return today;\n}\n\n/**\n * Дата через месяц (00:00).\n */\nexport function getNextMonth(): Date {\n    const today = getCurrentDate();\n    today.setMonth(today.getMonth() + 1);\n    return today;\n}\n\n/**\n * Последний день текущего месяца (00:00).\n */\nexport function getLastDayOfCurrentMonth(): Date {\n    const today = getCurrentDate();\n    return new Date(today.getFullYear(), today.getMonth() + 1, 0);\n}\n\n/**\n * Возвращает количество дней между двумя датами.\n * @param date1 - дата 1 начало\n * @param date2 - дата 2 конец\n */\nexport function differentDateInDay(date1: Date, date2: Date): number {\n    return Math.floor((date1.getTime() - date2.getTime()) / (1000 * 60 * 60 * 24)) * -1;\n}\n","export const urlAlphabet =\n  'useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict'\n","/* @ts-self-types=\"./index.d.ts\" */\nimport { urlAlphabet as scopedUrlAlphabet } from './url-alphabet/index.js'\nexport { urlAlphabet } from './url-alphabet/index.js'\nexport let random = bytes => crypto.getRandomValues(new Uint8Array(bytes))\nexport let customRandom = (alphabet, defaultSize, getRandom) => {\n  let mask = (2 << Math.log2(alphabet.length - 1)) - 1\n  let step = -~((1.6 * mask * defaultSize) / alphabet.length)\n  return (size = defaultSize) => {\n    let id = ''\n    while (true) {\n      let bytes = getRandom(step)\n      let j = step | 0\n      while (j--) {\n        id += alphabet[bytes[j] & mask] || ''\n        if (id.length >= size) return id\n      }\n    }\n  }\n}\nexport let customAlphabet = (alphabet, size = 21) =>\n  customRandom(alphabet, size | 0, random)\nexport let nanoid = (size = 21) => {\n  let id = ''\n  let bytes = crypto.getRandomValues(new Uint8Array((size |= 0)))\n  while (size--) {\n    id += scopedUrlAlphabet[bytes[size] & 63]\n  }\n  return id\n}\n","const instanceOfAny = (object, constructors) => constructors.some((c) => object instanceof c);\n\nlet idbProxyableTypes;\nlet cursorAdvanceMethods;\n// This is a function to prevent it throwing up in node environments.\nfunction getIdbProxyableTypes() {\n    return (idbProxyableTypes ||\n        (idbProxyableTypes = [\n            IDBDatabase,\n            IDBObjectStore,\n            IDBIndex,\n            IDBCursor,\n            IDBTransaction,\n        ]));\n}\n// This is a function to prevent it throwing up in node environments.\nfunction getCursorAdvanceMethods() {\n    return (cursorAdvanceMethods ||\n        (cursorAdvanceMethods = [\n            IDBCursor.prototype.advance,\n            IDBCursor.prototype.continue,\n            IDBCursor.prototype.continuePrimaryKey,\n        ]));\n}\nconst transactionDoneMap = new WeakMap();\nconst transformCache = new WeakMap();\nconst reverseTransformCache = new WeakMap();\nfunction promisifyRequest(request) {\n    const promise = new Promise((resolve, reject) => {\n        const unlisten = () => {\n            request.removeEventListener('success', success);\n            request.removeEventListener('error', error);\n        };\n        const success = () => {\n            resolve(wrap(request.result));\n            unlisten();\n        };\n        const error = () => {\n            reject(request.error);\n            unlisten();\n        };\n        request.addEventListener('success', success);\n        request.addEventListener('error', error);\n    });\n    // This mapping exists in reverseTransformCache but doesn't exist in transformCache. This\n    // is because we create many promises from a single IDBRequest.\n    reverseTransformCache.set(promise, request);\n    return promise;\n}\nfunction cacheDonePromiseForTransaction(tx) {\n    // Early bail if we've already created a done promise for this transaction.\n    if (transactionDoneMap.has(tx))\n        return;\n    const done = new Promise((resolve, reject) => {\n        const unlisten = () => {\n            tx.removeEventListener('complete', complete);\n            tx.removeEventListener('error', error);\n            tx.removeEventListener('abort', error);\n        };\n        const complete = () => {\n            resolve();\n            unlisten();\n        };\n        const error = () => {\n            reject(tx.error || new DOMException('AbortError', 'AbortError'));\n            unlisten();\n        };\n        tx.addEventListener('complete', complete);\n        tx.addEventListener('error', error);\n        tx.addEventListener('abort', error);\n    });\n    // Cache it for later retrieval.\n    transactionDoneMap.set(tx, done);\n}\nlet idbProxyTraps = {\n    get(target, prop, receiver) {\n        if (target instanceof IDBTransaction) {\n            // Special handling for transaction.done.\n            if (prop === 'done')\n                return transactionDoneMap.get(target);\n            // Make tx.store return the only store in the transaction, or undefined if there are many.\n            if (prop === 'store') {\n                return receiver.objectStoreNames[1]\n                    ? undefined\n                    : receiver.objectStore(receiver.objectStoreNames[0]);\n            }\n        }\n        // Else transform whatever we get back.\n        return wrap(target[prop]);\n    },\n    set(target, prop, value) {\n        target[prop] = value;\n        return true;\n    },\n    has(target, prop) {\n        if (target instanceof IDBTransaction &&\n            (prop === 'done' || prop === 'store')) {\n            return true;\n        }\n        return prop in target;\n    },\n};\nfunction replaceTraps(callback) {\n    idbProxyTraps = callback(idbProxyTraps);\n}\nfunction wrapFunction(func) {\n    // Due to expected object equality (which is enforced by the caching in `wrap`), we\n    // only create one new func per func.\n    // Cursor methods are special, as the behaviour is a little more different to standard IDB. In\n    // IDB, you advance the cursor and wait for a new 'success' on the IDBRequest that gave you the\n    // cursor. It's kinda like a promise that can resolve with many values. That doesn't make sense\n    // with real promises, so each advance methods returns a new promise for the cursor object, or\n    // undefined if the end of the cursor has been reached.\n    if (getCursorAdvanceMethods().includes(func)) {\n        return function (...args) {\n            // Calling the original function with the proxy as 'this' causes ILLEGAL INVOCATION, so we use\n            // the original object.\n            func.apply(unwrap(this), args);\n            return wrap(this.request);\n        };\n    }\n    return function (...args) {\n        // Calling the original function with the proxy as 'this' causes ILLEGAL INVOCATION, so we use\n        // the original object.\n        return wrap(func.apply(unwrap(this), args));\n    };\n}\nfunction transformCachableValue(value) {\n    if (typeof value === 'function')\n        return wrapFunction(value);\n    // This doesn't return, it just creates a 'done' promise for the transaction,\n    // which is later returned for transaction.done (see idbObjectHandler).\n    if (value instanceof IDBTransaction)\n        cacheDonePromiseForTransaction(value);\n    if (instanceOfAny(value, getIdbProxyableTypes()))\n        return new Proxy(value, idbProxyTraps);\n    // Return the same value back if we're not going to transform it.\n    return value;\n}\nfunction wrap(value) {\n    // We sometimes generate multiple promises from a single IDBRequest (eg when cursoring), because\n    // IDB is weird and a single IDBRequest can yield many responses, so these can't be cached.\n    if (value instanceof IDBRequest)\n        return promisifyRequest(value);\n    // If we've already transformed this value before, reuse the transformed value.\n    // This is faster, but it also provides object equality.\n    if (transformCache.has(value))\n        return transformCache.get(value);\n    const newValue = transformCachableValue(value);\n    // Not all types are transformed.\n    // These may be primitive types, so they can't be WeakMap keys.\n    if (newValue !== value) {\n        transformCache.set(value, newValue);\n        reverseTransformCache.set(newValue, value);\n    }\n    return newValue;\n}\nconst unwrap = (value) => reverseTransformCache.get(value);\n\n/**\n * Open a database.\n *\n * @param name Name of the database.\n * @param version Schema version.\n * @param callbacks Additional callbacks.\n */\nfunction openDB(name, version, { blocked, upgrade, blocking, terminated } = {}) {\n    const request = indexedDB.open(name, version);\n    const openPromise = wrap(request);\n    if (upgrade) {\n        request.addEventListener('upgradeneeded', (event) => {\n            upgrade(wrap(request.result), event.oldVersion, event.newVersion, wrap(request.transaction), event);\n        });\n    }\n    if (blocked) {\n        request.addEventListener('blocked', (event) => blocked(\n        // Casting due to https://github.com/microsoft/TypeScript-DOM-lib-generator/pull/1405\n        event.oldVersion, event.newVersion, event));\n    }\n    openPromise\n        .then((db) => {\n        if (terminated)\n            db.addEventListener('close', () => terminated());\n        if (blocking) {\n            db.addEventListener('versionchange', (event) => blocking(event.oldVersion, event.newVersion, event));\n        }\n    })\n        .catch(() => { });\n    return openPromise;\n}\n/**\n * Delete a database.\n *\n * @param name Name of the database.\n */\nfunction deleteDB(name, { blocked } = {}) {\n    const request = indexedDB.deleteDatabase(name);\n    if (blocked) {\n        request.addEventListener('blocked', (event) => blocked(\n        // Casting due to https://github.com/microsoft/TypeScript-DOM-lib-generator/pull/1405\n        event.oldVersion, event));\n    }\n    return wrap(request).then(() => undefined);\n}\n\nconst readMethods = ['get', 'getKey', 'getAll', 'getAllKeys', 'count'];\nconst writeMethods = ['put', 'add', 'delete', 'clear'];\nconst cachedMethods = new Map();\nfunction getMethod(target, prop) {\n    if (!(target instanceof IDBDatabase &&\n        !(prop in target) &&\n        typeof prop === 'string')) {\n        return;\n    }\n    if (cachedMethods.get(prop))\n        return cachedMethods.get(prop);\n    const targetFuncName = prop.replace(/FromIndex$/, '');\n    const useIndex = prop !== targetFuncName;\n    const isWrite = writeMethods.includes(targetFuncName);\n    if (\n    // Bail if the target doesn't exist on the target. Eg, getAll isn't in Edge.\n    !(targetFuncName in (useIndex ? IDBIndex : IDBObjectStore).prototype) ||\n        !(isWrite || readMethods.includes(targetFuncName))) {\n        return;\n    }\n    const method = async function (storeName, ...args) {\n        // isWrite ? 'readwrite' : undefined gzipps better, but fails in Edge :(\n        const tx = this.transaction(storeName, isWrite ? 'readwrite' : 'readonly');\n        let target = tx.store;\n        if (useIndex)\n            target = target.index(args.shift());\n        // Must reject if op rejects.\n        // If it's a write operation, must reject if tx.done rejects.\n        // Must reject with op rejection first.\n        // Must resolve with op value.\n        // Must handle both promises (no unhandled rejections)\n        return (await Promise.all([\n            target[targetFuncName](...args),\n            isWrite && tx.done,\n        ]))[0];\n    };\n    cachedMethods.set(prop, method);\n    return method;\n}\nreplaceTraps((oldTraps) => ({\n    ...oldTraps,\n    get: (target, prop, receiver) => getMethod(target, prop) || oldTraps.get(target, prop, receiver),\n    has: (target, prop) => !!getMethod(target, prop) || oldTraps.has(target, prop),\n}));\n\nconst advanceMethodProps = ['continue', 'continuePrimaryKey', 'advance'];\nconst methodMap = {};\nconst advanceResults = new WeakMap();\nconst ittrProxiedCursorToOriginalProxy = new WeakMap();\nconst cursorIteratorTraps = {\n    get(target, prop) {\n        if (!advanceMethodProps.includes(prop))\n            return target[prop];\n        let cachedFunc = methodMap[prop];\n        if (!cachedFunc) {\n            cachedFunc = methodMap[prop] = function (...args) {\n                advanceResults.set(this, ittrProxiedCursorToOriginalProxy.get(this)[prop](...args));\n            };\n        }\n        return cachedFunc;\n    },\n};\nasync function* iterate(...args) {\n    // tslint:disable-next-line:no-this-assignment\n    let cursor = this;\n    if (!(cursor instanceof IDBCursor)) {\n        cursor = await cursor.openCursor(...args);\n    }\n    if (!cursor)\n        return;\n    cursor = cursor;\n    const proxiedCursor = new Proxy(cursor, cursorIteratorTraps);\n    ittrProxiedCursorToOriginalProxy.set(proxiedCursor, cursor);\n    // Map this double-proxy back to the original, so other cursor methods work.\n    reverseTransformCache.set(proxiedCursor, unwrap(cursor));\n    while (cursor) {\n        yield proxiedCursor;\n        // If one of the advancing methods was not called, call continue().\n        cursor = await (advanceResults.get(proxiedCursor) || cursor.continue());\n        advanceResults.delete(proxiedCursor);\n    }\n}\nfunction isIteratorProp(target, prop) {\n    return ((prop === Symbol.asyncIterator &&\n        instanceOfAny(target, [IDBIndex, IDBObjectStore, IDBCursor])) ||\n        (prop === 'iterate' && instanceOfAny(target, [IDBIndex, IDBObjectStore])));\n}\nreplaceTraps((oldTraps) => ({\n    ...oldTraps,\n    get(target, prop, receiver) {\n        if (isIteratorProp(target, prop))\n            return iterate;\n        return oldTraps.get(target, prop, receiver);\n    },\n    has(target, prop) {\n        return isIteratorProp(target, prop) || oldTraps.has(target, prop);\n    },\n}));\n\nexport { deleteDB, openDB, unwrap, wrap };\n","import { openDB, type DBSchema, type IDBPDatabase, type StoreKey, type StoreNames, type StoreValue } from 'idb';\n\n/**\n * Колбэк для апгрейда схемы БД.\n * DB — схема IndexedDB (DBSchema).\n */\nexport type UpgradeCallback<DB extends DBSchema> = (\n    db: IDBPDatabase<DB>,\n    oldVersion: number,\n    newVersion: number | null\n) => void;\n\n/**\n * Обёртка над `idb` с безопасными типами.\n *\n * @template DB - схема БД (DBSchema).\n */\nexport class IndexedDBService<DB extends DBSchema> {\n    /**\n     * Экземпляр открытой БД.\n     * `null` возможен только до инициализации.\n     */\n    #db: IDBPDatabase<DB> | null = null;\n\n    constructor(db: IDBPDatabase<DB>) {\n        this.#db = db;\n    }\n\n    /**\n     * Открывает БД и выполняет upgrade при необходимости.\n     *\n     * @param name - имя БД\n     * @param version - версия схемы\n     * @param onUpgrade - колбэк для миграций\n     */\n    static async open<DB extends DBSchema>(\n        name: string,\n        version: number,\n        onUpgrade?: UpgradeCallback<DB>\n    ): Promise<IndexedDBService<DB>> {\n        if (!('indexedDB' in window)) {\n            throw new Error('IndexedDB не поддерживается браузером');\n        }\n\n        const db = await openDB<DB>(name, version, {\n            upgrade(db, oldVersion, newVersion) {\n                onUpgrade?.(db, oldVersion, newVersion);\n            },\n        });\n\n        return new IndexedDBService<DB>(db);\n    }\n\n    /**\n     * Получить запись по ключу.\n     *\n     * @param storeName - имя хранилища\n     * @param key - ключ записи\n     */\n    get<S extends StoreNames<DB>>(storeName: S, key: StoreKey<DB, S>): Promise<StoreValue<DB, S> | undefined> {\n        this.#ensureDb();\n        return this.#db!.get(storeName, key);\n    }\n\n    /**\n     * Получить все записи из хранилища.\n     *\n     * @param storeName - имя хранилища\n     */\n    getAll<S extends StoreNames<DB>>(storeName: S): Promise<Array<StoreValue<DB, S>>> {\n        this.#ensureDb();\n        return this.#db!.getAll(storeName);\n    }\n\n    /**\n     * Добавить или обновить запись.\n     *\n     * Если у objectStore задан `keyPath`, ключ можно не передавать.\n     * Если `keyPath` нет — передай ключ параметром `key`.\n     *\n     * @param storeName - имя хранилища\n     * @param value - сохраняемое значение\n     * @param key - ключ (опционально)\n     */\n    put<S extends StoreNames<DB>>(\n        storeName: S,\n        value: StoreValue<DB, S>,\n        key?: StoreKey<DB, S>\n    ): Promise<StoreKey<DB, S>> {\n        this.#ensureDb();\n        return key !== undefined ? this.#db!.put(storeName, value, key) : this.#db!.put(storeName, value);\n    }\n\n    /**\n     * Удалить запись по ключу.\n     *\n     * @param storeName - имя хранилища\n     * @param key - ключ записи\n     */\n    delete<S extends StoreNames<DB>>(storeName: S, key: StoreKey<DB, S>): Promise<void> {\n        this.#ensureDb();\n        return this.#db!.delete(storeName, key);\n    }\n\n    /**\n     * Очистить хранилище.\n     *\n     * @param storeName - имя хранилища\n     */\n    clear<S extends StoreNames<DB>>(storeName: S): Promise<void> {\n        this.#ensureDb();\n        return this.#db!.clear(storeName);\n    }\n\n    /**\n     * Проверяет, что БД инициализирована.\n     */\n    #ensureDb(): void {\n        if (!this.#db) {\n            throw new Error('База данных не инициализирована');\n        }\n    }\n}\n","import { nanoid } from 'nanoid';\n\nimport { balanceDBName, balanceDBVersion, balanceTableName } from '../../constant.ts';\nimport { BalanceId, IBalance } from '../../models/balance/IBalance.ts';\n\nimport { IndexedDBService } from './db.ts';\nimport { BalanceCreateInput, BalanceDB, SaveBalanceResult } from './types.ts';\n\n/**\n * Открытие БД с типизированной схемой.\n */\nexport const balanceDBPromise = IndexedDBService.open<BalanceDB>(balanceDBName, balanceDBVersion, (db) => {\n    if (!db.objectStoreNames.contains(balanceTableName)) {\n        db.createObjectStore(balanceTableName, { keyPath: 'id' });\n    }\n});\n\n/**\n * Создать или обновить баланс.\n */\nexport async function saveBalance(record: BalanceCreateInput): Promise<SaveBalanceResult> {\n    const db = await balanceDBPromise;\n\n    const id = record.id ?? nanoid();\n    const balance: IBalance = { ...record, id };\n\n    await db.put(balanceTableName, balance);\n\n    return balance;\n}\n\n/**\n * Получить баланс по id.\n */\nexport async function getBalance(id: BalanceId): Promise<IBalance | undefined> {\n    const db = await balanceDBPromise;\n    return db.get(balanceTableName, id);\n}\n\n/**\n * Получить все балансы.\n */\nexport async function getAllBalances(): Promise<IBalance[]> {\n    const db = await balanceDBPromise;\n    return db.getAll(balanceTableName);\n}\n","import { nanoid } from 'nanoid';\n\nimport { transactionDBName, transactionDBVersion, transactionTableName } from '../../constant.ts';\nimport { ITransaction } from '../../models/transaction/ITransaction.ts';\n\nimport { IndexedDBService } from './db.ts';\nimport { ITransactionCreate, SaveTransactionResult, TransactionDB, TransactionId } from './types.ts';\n\n/**\n * Открытие БД с типизированной схемой.\n */\nexport const transactionDBPromise = IndexedDBService.open<TransactionDB>(\n    transactionDBName,\n    transactionDBVersion,\n    (db) => {\n        if (!db.objectStoreNames.contains(transactionTableName)) {\n            db.createObjectStore(transactionTableName, { keyPath: 'id' });\n        }\n    }\n);\n\n/**\n * Создать или обновить транзакцию.\n */\nexport async function saveTransaction(transaction: ITransactionCreate): Promise<SaveTransactionResult> {\n    const db = await transactionDBPromise;\n\n    const id = nanoid();\n    const record: ITransaction = { ...transaction, id };\n\n    await db.put(transactionTableName, record);\n\n    return id;\n}\n\n/**\n * Получить транзакцию по id.\n */\nexport async function getTransaction(id: TransactionId): Promise<ITransaction | undefined> {\n    const db = await transactionDBPromise;\n    return db.get(transactionTableName, id);\n}\n\n/**\n * Получить все транзакции.\n */\nexport async function getAllTransactions(): Promise<ITransaction[]> {\n    const db = await transactionDBPromise;\n    return db.getAll(transactionTableName);\n}\n","import { LS_NAME_SPACE, SYSTEM_EVENTS } from '../constant.ts';\nimport { IEvents } from '../events/events.ts';\nimport { IBalance, IBalanceModel } from '../models/balance/IBalance.ts';\nimport { ITransaction, ITransactionModel } from '../models/transaction/ITransaction.ts';\nimport { getCurrentDate } from '../utils/date/dateUtils.ts';\nimport { getAllBalances, getBalance, saveBalance } from '../utils/db/balanceDB.ts';\nimport { getAllTransactions } from '../utils/db/transactionDB.ts';\n\nimport { IAppStore } from './types.ts';\n\nexport class AppStore implements IAppStore {\n    private readonly events: IEvents;\n    private readonly balanceModel: IBalanceModel;\n    private readonly transactionModel: ITransactionModel;\n\n    private initBalanceCompleted = false;\n\n    constructor(events: IEvents, balanceModel: IBalanceModel, transactionModel: ITransactionModel) {\n        this.events = events;\n        this.balanceModel = balanceModel;\n        this.transactionModel = transactionModel;\n        this.initBalanceCompleted = localStorage.getItem(LS_NAME_SPACE.INIT_BALANCE) === 'true';\n\n        if (!this.initBalanceCompleted) {\n            this.events.on(SYSTEM_EVENTS.INIT_BALANCE, () => {\n                this.completeWelcome();\n            });\n        }\n    }\n\n    public isWelcomeCompleted(): boolean {\n        return this.initBalanceCompleted;\n    }\n\n    /**\n     * Инициализация доменных данных приложения.\n     */\n    public async init(): Promise<void> {\n        await this.initBalance();\n        await this.initTransactions();\n    }\n\n    /**\n     * Отмечает онбординг завершённым и уведомляет систему.\n     */\n    public completeWelcome(): void {\n        this.initBalanceCompleted = true;\n        localStorage.setItem(LS_NAME_SPACE.INIT_BALANCE, 'true');\n    }\n\n    private async initTransactions(): Promise<void> {\n        try {\n            const transactions: ITransaction[] = await getAllTransactions();\n\n            this.transactionModel.setTransactions(transactions);\n        } catch (err) {\n            console.error(err);\n        }\n\n        return;\n    }\n\n    private async initBalance(): Promise<void> {\n        try {\n            const balance: IBalance | undefined = await getBalance(getCurrentDate().toISOString());\n\n            if (!balance) {\n                const balances: IBalance[] = await getAllBalances();\n\n                if (balances.length === 0) {\n                    await saveBalance(this.balanceModel.getBalanceData());\n                } else {\n                    const balance: IBalance = balances[balances.length - 1];\n                    const newBalance: IBalance = {\n                        ...balance,\n                        id: getCurrentDate().toISOString(),\n                        wasted: 0,\n                    };\n\n                    await saveBalance(newBalance);\n\n                    this.balanceModel.updateBalance(newBalance);\n                }\n            } else {\n                this.balanceModel.updateBalance(balance);\n            }\n        } catch (err) {\n            console.error(err);\n        }\n\n        return;\n    }\n}\n","import { IRouter, IScreen } from './types.ts';\n\nexport class Router implements IRouter {\n    private current: IScreen | null = null;\n\n    constructor(private readonly screens: Record<string, IScreen>) {}\n\n    /**\n     * Переключает экран, гарантируя корректный leave() текущего.\n     */\n    public async go(name: string): Promise<void> {\n        const next = this.screens[name];\n\n        if (!next) {\n            return;\n        }\n\n        if (this.current !== next) {\n            this.current?.leave();\n            this.current = next;\n        }\n\n        await next.enter(name);\n    }\n\n    public destroy(): void {\n        this.current?.leave();\n        this.current = null;\n    }\n}\n","import { SYSTEM_NAME_SPACE } from '../constant.ts';\nimport {\n    IBalancePresenter,\n    IDayLimitPresenter,\n    ITransactionPresenter,\n    IWelcomePagePresenter,\n} from '../presenters/types.ts';\n\nimport { IScreen } from './types.ts';\n\nexport class WelcomeScreen implements IScreen {\n    private readonly welcomePagePresenter: IWelcomePagePresenter;\n\n    constructor(welcomePagePresenter: IWelcomePagePresenter) {\n        this.welcomePagePresenter = welcomePagePresenter;\n    }\n\n    enter(): void {\n        this.welcomePagePresenter.init();\n    }\n\n    leave(): void {\n        this.welcomePagePresenter.destroy();\n    }\n}\n\nexport class MainScreen implements IScreen {\n    constructor(\n        private readonly balancePresenter: IBalancePresenter,\n        private readonly dayLimitPresenter: IDayLimitPresenter,\n        private readonly transactionPresenter: ITransactionPresenter\n    ) {}\n\n    enter(page: string): void {\n        switch (page) {\n            case SYSTEM_NAME_SPACE.BALANCE_PAGE: {\n                this.dayLimitPresenter.destroy();\n                this.transactionPresenter.destroy();\n\n                this.balancePresenter.initOverflow();\n\n                break;\n            }\n            case SYSTEM_NAME_SPACE.TRANSACTION_PAGE: {\n                this.balancePresenter.destroy();\n                this.dayLimitPresenter.destroy();\n\n                this.transactionPresenter.initOverflow();\n\n                break;\n            }\n            default: {\n                this.balancePresenter.overflowDestroy();\n                this.transactionPresenter.overflowDestroy();\n\n                this.balancePresenter.init();\n                this.dayLimitPresenter.init();\n                this.transactionPresenter.init();\n            }\n        }\n    }\n\n    leave(): void {\n        this.balancePresenter.destroy();\n        this.dayLimitPresenter.destroy();\n        this.transactionPresenter.destroy();\n    }\n}\n","type EventName = string | RegExp;\ntype Subscriber = Function;\ninterface EmitterEvent {\n    eventName: string;\n    data: unknown;\n}\n\nexport interface IEvents {\n    on<T extends object>(event: EventName, callback: (data: T) => void): void;\n    emit<T extends object>(event: string, data?: T): void;\n    trigger<T extends object>(event: string, context?: Partial<T>): (data: T) => void;\n}\n\n/**\n * Брокер событий, классическая реализация\n */\nexport class EventEmitter implements IEvents {\n    _events: Map<EventName, Set<Subscriber>>;\n\n    constructor() {\n        this._events = new Map<EventName, Set<Subscriber>>();\n    }\n\n    /**\n     * Установить обработчик на событие\n     */\n    on<T extends object>(eventName: EventName, callback: (event: T) => void) {\n        if (!this._events.has(eventName)) {\n            this._events.set(eventName, new Set<Subscriber>());\n        }\n        this._events.get(eventName)?.add(callback);\n    }\n\n    /**\n     * Снять обработчик с события\n     */\n    off(eventName: EventName, callback: Subscriber) {\n        if (this._events.has(eventName)) {\n            this._events.get(eventName)!.delete(callback);\n            if (this._events.get(eventName)?.size === 0) {\n                this._events.delete(eventName);\n            }\n        }\n    }\n\n    /**\n     * Инициировать событие с данными\n     */\n    emit<T extends object>(eventName: string, data?: T) {\n        this._events.forEach((subscribers, name) => {\n            if (name === '*') {\n                subscribers.forEach((callback) =>\n                    callback({\n                        eventName,\n                        data,\n                    })\n                );\n            }\n            if ((name instanceof RegExp && name.test(eventName)) || name === eventName) {\n                subscribers.forEach((callback) => callback(data));\n            }\n        });\n    }\n\n    /**\n     * Слушать все события\n     */\n    onAll(callback: (event: EmitterEvent) => void) {\n        this.on('*', callback);\n    }\n\n    /**\n     * Сбросить все обработчики\n     */\n    offAll() {\n        this._events = new Map<string, Set<Subscriber>>();\n    }\n\n    /**\n     * Сделать коллбек триггер, генерирующий событие при вызове\n     */\n    trigger<T extends object>(eventName: string, context?: Partial<T>) {\n        return (event: object = {}) => {\n            this.emit(eventName, {\n                ...(event || {}),\n                ...(context || {}),\n            });\n        };\n    }\n}\n","import { SYSTEM_EVENTS } from '../../constant.ts';\nimport { IEvents } from '../../events/events.ts';\nimport { differentDateInDay, getCurrentDate } from '../../utils/date/dateUtils.ts';\nimport { saveBalance } from '../../utils/db/balanceDB.ts';\nimport { getTransaction, saveTransaction } from '../../utils/db/transactionDB.ts';\nimport { ITransactionCreate } from '../../utils/db/types.ts';\nimport { IBalance, IBalanceModel } from '../balance/IBalance.ts';\nimport { ITransaction, ITransactionModel } from '../transaction/ITransaction.ts';\n\nimport { IAccountModel, IBalanceLimit } from './IAccount.ts';\n\nexport class AccountModel implements IAccountModel {\n    private readonly events: IEvents;\n    private readonly balanceModel: IBalanceModel;\n    private readonly transactionModel: ITransactionModel;\n\n    constructor(events: IEvents, balanceModel: IBalanceModel, transactionModel: ITransactionModel) {\n        this.events = events;\n        this.balanceModel = balanceModel;\n        this.transactionModel = transactionModel;\n    }\n\n    public getBalance(): IBalance {\n        return this.balanceModel.getBalanceData();\n    }\n\n    public getBalanceLimit(): IBalanceLimit {\n        const balance = this.balanceModel.getBalanceData();\n\n        return {\n            inLimit: balance.dayLimit - balance.wasted >= 0,\n            remained: balance.dayLimit - balance.wasted,\n            limit: balance.dayLimit,\n            wasted: balance.wasted,\n        };\n    }\n\n    public async upBalance(value: number, date: Date): Promise<void> {\n        const currentBalance: IBalance = this.balanceModel.getBalanceData();\n        const diffDays: number = differentDateInDay(getCurrentDate(), date);\n        const newValue = currentBalance.value + value;\n\n        const newBalance: IBalance = {\n            id: currentBalance.id,\n            endDate: date.toISOString(),\n            value: newValue,\n            wasted: currentBalance.wasted,\n            dayLimit: newValue / diffDays,\n            avgDayWasted: currentBalance.avgDayWasted,\n        };\n\n        await this.saveBalanceInDB(newBalance);\n\n        this.balanceModel.updateBalance(newBalance);\n\n        this.events.emit(SYSTEM_EVENTS.BALANCE_UPDATED);\n    }\n\n    public async initBalance(startBalance: number, endDate: Date): Promise<void> {\n        const diffDays: number = differentDateInDay(getCurrentDate(), endDate);\n\n        const newBalance: IBalance = {\n            id: getCurrentDate().toISOString(),\n            endDate: endDate.toISOString(),\n            value: startBalance,\n            wasted: 0,\n            dayLimit: startBalance / diffDays,\n            avgDayWasted: 0,\n        };\n\n        await this.saveBalanceInDB(newBalance);\n\n        this.balanceModel.updateBalance(newBalance);\n    }\n\n    public async addTransaction(createDataTransaction: ITransactionCreate): Promise<void> {\n        const transactionId: string = await this.saveTransactionInDB(createDataTransaction);\n        const transaction: ITransaction | undefined = await this.getTransactionByIdInDB(transactionId);\n\n        if (!transaction) {\n            throw new Error('Transaction not found');\n        }\n\n        this.transactionModel.createTransaction(transaction);\n        this.events.emit(SYSTEM_EVENTS.TRANSACTION_UPDATED);\n\n        await this.addWasted(transaction.value);\n    }\n\n    public getTransactions(): ITransaction[] {\n        return this.transactionModel.getTransactions();\n    }\n\n    public getTransactionsCount(): number {\n        return this.transactionModel.getTransactionsCount();\n    }\n\n    private async addWasted(wasted: number): Promise<void> {\n        const balance = this.balanceModel.getBalanceData();\n        const transactionsCount = this.transactionModel.getTransactionsCount();\n\n        if (wasted > balance.value) {\n            throw new Error('Wasted cannot be greater than value');\n        }\n\n        let newBalance = {\n            ...balance,\n            value: balance.value - wasted,\n            wasted: balance.wasted + wasted,\n            avgDayWasted: balance.wasted / transactionsCount,\n        };\n\n        if (wasted > balance.dayLimit - balance.wasted) {\n            const diffDays: number = differentDateInDay(getCurrentDate(), new Date(newBalance.endDate));\n\n            newBalance = {\n                ...newBalance,\n                dayLimit: newBalance.value / diffDays,\n            };\n        }\n\n        await this.saveBalanceInDB(newBalance);\n\n        this.balanceModel.updateBalance(newBalance);\n\n        this.events.emit(SYSTEM_EVENTS.BALANCE_UPDATED);\n    }\n\n    private async saveBalanceInDB(balance: IBalance): Promise<IBalance> {\n        return await saveBalance(balance);\n    }\n\n    private async saveTransactionInDB(transaction: ITransactionCreate): Promise<string> {\n        return await saveTransaction(transaction);\n    }\n\n    private async getTransactionByIdInDB(transactionId: string): Promise<ITransaction | undefined> {\n        return await getTransaction(transactionId);\n    }\n}\n","import { differentDateInDay, getCurrentDate } from '../../utils/date/dateUtils.ts';\n\nimport { IBalance, IBalanceModel } from './IBalance.ts';\n\nexport class BalanceModel implements IBalanceModel {\n    private date: Date = getCurrentDate();\n    private endDate: Date = getCurrentDate();\n    private value: number = 0;\n    private wasted: number = 0;\n    private dayLimit: number = 0;\n    private avgDayWasted: number = 0;\n\n    public getBalanceData(): IBalance {\n        return {\n            id: this.date.toISOString(),\n            endDate: this.endDate.toISOString(),\n            value: this.value,\n            wasted: this.wasted,\n            dayLimit: this.dayLimit,\n            avgDayWasted: this.avgDayWasted,\n        };\n    }\n\n    public updateBalance(balance: IBalance) {\n        const endDate: Date = new Date(balance.endDate);\n        const diffDays: number = differentDateInDay(this.date, endDate);\n\n        this.endDate = endDate;\n        this.value = balance.value;\n        this.wasted = balance.wasted;\n        this.dayLimit = balance.value / diffDays;\n        this.avgDayWasted = balance.avgDayWasted;\n    }\n}\n","import { ITransaction, ITransactionModel } from './ITransaction.ts';\n\nexport class TransactionModel implements ITransactionModel {\n    private transactions: ITransaction[] = [];\n\n    /**\n     * Устанавливает список транзакций извне\n     * и сортирует их по дате (новые сверху)\n     */\n    public setTransactions(transactions: ITransaction[]): void {\n        this.transactions = [...transactions].sort(this.sortByDateDesc);\n    }\n\n    /**\n     * Возвращает отсортированный список транзакций\n     */\n    public getTransactions(): ITransaction[] {\n        return this.transactions;\n    }\n\n    public getTransaction(id: string): ITransaction | undefined {\n        return this.transactions.find((transaction) => transaction.id === id);\n    }\n\n    public getTransactionsCount(): number {\n        return this.transactions.length;\n    }\n\n    /**\n     * Создаёт новую транзакцию и добавляет её вверх списка\n     */\n    public createTransaction(transaction: ITransaction): void {\n        this.transactions.unshift(transaction);\n    }\n\n    public deleteTransaction(id: string): void {\n        this.transactions = this.transactions.filter((transaction) => transaction.id !== id);\n    }\n\n    /**\n     * Сортировка по дате: от новых к старым\n     */\n    private sortByDateDesc(a: ITransaction, b: ITransaction): number {\n        return new Date(b.date).getTime() - new Date(a.date).getTime();\n    }\n}\n","/**\n * Стабильный dateFormatter\n */\nexport function dateFormatter(date: Date): string {\n    return new Intl.DateTimeFormat('ru-RU', {\n        day: 'numeric',\n        month: 'long',\n    }).format(date);\n}\n\n/**\n * Стабильный dateFormatter\n * Формат: \"26 02 2026\"\n */\nexport function dateFullFormatter(date: Date): string {\n    return new Intl.DateTimeFormat('ru-RU', {\n        day: 'numeric',\n        month: 'numeric',\n        year: 'numeric',\n    }).format(date);\n}\n","import { ISelector, ISelectorClass } from './ISelector.ts';\n\nexport class Selector implements ISelectorClass {\n    protected hiddenInput: HTMLInputElement | undefined = undefined;\n    protected selector: HTMLFieldSetElement | undefined = undefined;\n    protected dropdown: HTMLDivElement | undefined = undefined;\n    protected input: HTMLInputElement | undefined = undefined;\n    protected button: HTMLButtonElement | undefined = undefined;\n    protected name: string = '';\n    protected title: string = '';\n    protected placeholder: string = '';\n    protected options: { value: string; label: string }[] = [];\n\n    constructor(data: ISelector) {\n        this.name = data.name;\n        this.title = data.title;\n        this.placeholder = data.placeholder;\n        this.options = data.options ?? [];\n\n        /**\n         * Корневой контейнер селектора\n         * fieldset — семантически корректная группа элементов формы\n         */\n        const selector = document.createElement('fieldset');\n        selector.classList.add('selector');\n\n        /**\n         * Заголовок группы\n         */\n        const legend = document.createElement('legend');\n        legend.classList.add('selector__title', 'caption');\n        legend.textContent = this.title;\n\n        /**\n         * Инпут (read-only)\n         */\n        const input = document.createElement('input');\n        input.classList.add('selector__input');\n        input.placeholder = this.placeholder;\n        input.name = 'input';\n        input.readOnly = true;\n\n        this.input = input;\n\n        const hiddenInput = document.createElement('input');\n        hiddenInput.type = 'hidden';\n        hiddenInput.name = this.name;\n\n        this.hiddenInput = hiddenInput;\n\n        /**\n         * Кнопка открытия меню\n         */\n        const button = document.createElement('button');\n        button.classList.add('selector__drop_button');\n        button.type = 'button';\n\n        const img = document.createElement('img');\n        img.classList.add('selector__drop_button-img');\n        img.src = 'src/assets/down.svg';\n        img.alt = 'dropdown button';\n\n        button.appendChild(img);\n\n        this.button = button;\n\n        /**\n         * Выпадающее меню\n         */\n        const dropdown = document.createElement('div');\n        dropdown.classList.add('dropdown_menu');\n\n        selector.append(legend, input, hiddenInput, button, dropdown);\n\n        this.selector = selector;\n        this.dropdown = dropdown;\n\n        this.selector.addEventListener('click', this.onButtonClick.bind(this));\n        this.dropdown.addEventListener('click', this.onDropdownItemClick.bind(this));\n        document.addEventListener('click', this.onDocumentClick.bind(this));\n    }\n\n    public destroy(): void {\n        this.selector?.removeEventListener('click', this.onButtonClick.bind(this));\n        this.dropdown?.removeEventListener('click', this.onDropdownItemClick.bind(this));\n\n        document.removeEventListener('click', this.onDocumentClick.bind(this));\n    }\n\n    /**\n     * Получить DOM-узел селектора\n     */\n    public getNode(): HTMLFieldSetElement {\n        return this.selector || document.createElement('fieldset');\n    }\n\n    /**\n     * Открыть выпадающее меню\n     */\n    protected openDropdown() {\n        if (!this.dropdown) {\n            return;\n        }\n\n        this.dropdown.replaceChildren();\n        this.renderOptions(this.dropdown);\n        this.dropdown.classList.add('dropdown_menu-visible');\n    }\n\n    /**\n     * Закрыть выпадающее меню\n     */\n    protected closeDropdown() {\n        if (!this.dropdown) {\n            return;\n        }\n\n        this.dropdown.classList.remove('dropdown_menu-visible');\n    }\n\n    /**\n     * Рендер стандартных опций\n     */\n    protected renderOptions(dropdown: HTMLDivElement) {\n        this.options.forEach((opt) => {\n            const item = document.createElement('button');\n\n            item.type = 'button';\n            item.classList.add('dropdown_menu--item');\n            item.dataset.value = opt.value;\n            item.textContent = opt.label;\n\n            dropdown.appendChild(item);\n        });\n    }\n\n    /**\n     * Обработка клика по пункту выпадающего меню\n     */\n    private onDropdownItemClick = (evt: MouseEvent) => {\n        evt.stopPropagation();\n\n        const target = evt.target as HTMLElement;\n        const el: HTMLButtonElement | null = target.closest<HTMLButtonElement>('[data-value]');\n\n        if (!el || !this.input || !this.hiddenInput || !this.dropdown) {\n            return;\n        }\n\n        this.input.value = el.dataset.value ?? '';\n\n        this.hiddenInput.value = el.value ?? '';\n\n        // Специальный пункт (например, \"Своя дата\")\n        if (el.dataset.option === 'offOnDropdownClick') {\n            return;\n        }\n\n        this.dropdown.classList.remove('dropdown_menu-visible');\n    };\n\n    /**\n     * Открытие / закрытие выпадающего меню\n     */\n    private onButtonClick(evt: Event) {\n        evt.stopPropagation();\n\n        const target = evt.target as HTMLElement;\n\n        // Игнорируем клики внутри dropdown\n        if (!this.dropdown || !this.button || !this.input || this.dropdown.contains(target)) {\n            return;\n        }\n\n        if (target === this.input || this.button.contains(target)) {\n            if (!this.dropdown.classList.contains('dropdown_menu-visible')) {\n                this.openDropdown();\n            } else {\n                this.closeDropdown();\n            }\n        }\n    }\n\n    /**\n     * Закрытие меню по клику вне компонента\n     */\n    private onDocumentClick(evt: MouseEvent) {\n        const target = evt.target as HTMLElement;\n\n        if (!this.selector || !this.selector.contains(target)) {\n            this.dropdown?.classList.remove('dropdown_menu-visible');\n        }\n    }\n}\n","import {\n    getLastDayOfCurrentMonth,\n    getNextDay,\n    getNextMonth,\n    getNextTwoWeek,\n    getNextWeek,\n} from '../../utils/date/dateUtils.ts';\nimport { dateFormatter } from '../../utils/formatters/dateFormatter.ts';\nimport { Selector } from '../selector/selecor.ts';\n\nimport { ICalendar, ICalendarClass } from './ICalendar.ts';\nimport { IDateSelector } from './IDateSelector.ts';\n\nexport class Calendar extends Selector implements ICalendarClass {\n    private readonly dateSelector: IDateSelector | null = null;\n\n    private baseOptions = {\n        nextDay: { value: getNextDay(), label: 'День' },\n        nextWeek: { value: getNextWeek(), label: 'Неделя' },\n        nextTwoWeek: { value: getNextTwoWeek(), label: 'Две недели' },\n        nextMonth: { value: getNextMonth(), label: 'Месяц' },\n        lastDayOfMonth: { value: getLastDayOfCurrentMonth(), label: 'До конца месяца' },\n    };\n\n    constructor(data: ICalendar, dateSelector: IDateSelector) {\n        super(data);\n        this.dateSelector = dateSelector;\n    }\n\n    /**\n     * Установить значение календаря извне.\n     *\n     * - Принимает Date или ISO-строку.\n     * - Обновляет значение инпута селектора (отображаемое значение).\n     * - Прокидывает дату в DateSelector через setDefaultValue(),\n     *   чтобы кастомный календарь показывал корректный месяц/день.\n     *\n     * @param value Дата (Date | ISO string)\n     * @param label Необязательный текст для инпута. Если не передан — будет \"до {date}\"\n     */\n    public setValue(value: Date | string, label?: string): void {\n        const parsed = typeof value === 'string' ? new Date(value) : new Date(value);\n\n        if (Number.isNaN(parsed.getTime())) {\n            return;\n        }\n\n        parsed.setHours(23, 59, 59, 999);\n\n        this.dateSelector?.setDefaultValue(parsed);\n\n        if (this.input && this.hiddenInput) {\n            this.input.value = label ?? `до ${dateFormatter(parsed)}`;\n\n            this.hiddenInput.value = parsed.toISOString() ?? '';\n        }\n    }\n\n    override openDropdown() {\n        super.openDropdown();\n\n        if (!this.dropdown) {\n            return;\n        }\n\n        this.dropdown.addEventListener('click', this.onDropdownCalendarClick.bind(this));\n    }\n\n    override closeDropdown() {\n        super.closeDropdown();\n\n        if (!this.dropdown) {\n            return;\n        }\n\n        this.dropdown.removeEventListener('click', this.onDropdownCalendarClick.bind(this));\n    }\n\n    protected renderCalendar(dropdown: HTMLDivElement) {\n        if (!this.dateSelector) {\n            return;\n        }\n\n        dropdown.replaceChildren();\n\n        const calendar = this.dateSelector.getNode();\n\n        dropdown.appendChild(calendar);\n    }\n\n    protected override renderOptions(dropdown: HTMLDivElement) {\n        dropdown.replaceChildren();\n\n        const getMenuItem = () => {\n            const item = document.createElement('button');\n            const span1 = document.createElement('span');\n            const span2 = document.createElement('span');\n\n            item.type = 'button';\n            item.classList.add('dropdown_menu--item');\n\n            return { item, span1, span2 };\n        };\n\n        Object.entries(this.baseOptions).forEach(([key, option]) => {\n            const { item, span1, span2 } = getMenuItem();\n\n            span1.textContent = option.label;\n            span2.textContent = `до ${dateFormatter(option.value)}`;\n\n            option.value.setHours(23, 59, 59, 999);\n\n            item.value = option.value.toISOString().toString();\n            item.dataset.key = key;\n            item.dataset.value = `${option.label} (до ${dateFormatter(option.value)})`;\n\n            item.append(span1, span2);\n            dropdown.appendChild(item);\n        });\n\n        // \"Своя дата\"\n        const { item, span1, span2 } = getMenuItem();\n        span1.textContent = 'Своя дата';\n\n        item.value = 'customDate';\n        item.dataset.key = 'customDate';\n        item.dataset.value = 'Своя дата';\n        item.dataset.option = 'offOnDropdownClick';\n\n        item.append(span1, span2);\n        dropdown.appendChild(item);\n    }\n\n    /**\n     * Стабильный listener\n     */\n    private onDropdownCalendarClick = (evt: MouseEvent) => {\n        evt.stopPropagation();\n\n        if (!this.dropdown) {\n            return;\n        }\n\n        const target = evt.target as HTMLElement;\n        const item = target.closest<HTMLButtonElement>('.dropdown_menu--item');\n\n        if (!item) {\n            return;\n        }\n\n        if (item.dataset.key === 'customDate') {\n            this.renderCalendar(this.dropdown);\n        }\n    };\n}\n","export default \"data:image/svg+xml,%3csvg%20width='10'%20height='18'%20viewBox='0%200%2010%2018'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M0.75%2016.75L8.75%208.75L0.749999%200.749999'%20stroke='%23111827'%20stroke-width='1.5'%20stroke-linecap='round'/%3e%3c/svg%3e\"","export default \"data:image/svg+xml,%3csvg%20width='10'%20height='18'%20viewBox='0%200%2010%2018'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M9.06055%200.75L1.06055%208.75L9.06055%2016.75'%20stroke='%236B7280'%20stroke-width='1.5'%20stroke-linecap='round'/%3e%3c/svg%3e\"","export default \"data:image/svg+xml,%3csvg%20width='10'%20height='18'%20viewBox='0%200%2010%2018'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M9.06055%200.75L1.06055%208.75L9.06055%2016.75'%20stroke='%23111827'%20stroke-width='1.5'%20stroke-linecap='round'/%3e%3c/svg%3e\"","import nextSvg from '../../assets/next.svg';\nimport prevDisabledSvg from '../../assets/prev-disabled.svg';\nimport prevSvg from '../../assets/prev.svg';\nimport { getCurrentDate } from '../../utils/date/dateUtils.ts';\n\nexport class DateSelector {\n    calendarNode: HTMLElement | undefined;\n    datePickerNode: HTMLElement | undefined;\n    prevButtonNode: HTMLButtonElement | undefined;\n    nextButtonNode: HTMLButtonElement | undefined;\n    currentDate: Date = getCurrentDate();\n    selectedDate: Date = getCurrentDate();\n    /**\n     * Стабильный dateFormatter\n     */\n    private formatterDay = new Intl.DateTimeFormat('ru-RU', {\n        day: 'numeric',\n    });\n    /**\n     * Стабильный dateFormatter\n     */\n    private formatterMount = new Intl.DateTimeFormat('ru-RU', {\n        day: 'numeric',\n        month: 'long',\n    });\n\n    constructor() {\n        this.currentDate.setHours(23, 59, 59, 999);\n\n        const last_day = new Date(this.currentDate.getFullYear(), this.currentDate.getMonth() + 1, 0, 23, 59, 59);\n\n        if (last_day.getDate() === this.currentDate.getDate()) {\n            this.selectedDate.setMonth(this.selectedDate.getMonth() + 1);\n            this.selectedDate.setDate(0);\n        }\n\n        this.createCalendarNode();\n    }\n\n    public destroy() {\n        this.prevButtonNode?.removeEventListener('click', this.handlePrevMount.bind(this));\n        this.nextButtonNode?.removeEventListener('click', this.handleNextMount.bind(this));\n\n        this.calendarNode?.remove();\n\n        this.calendarNode = undefined;\n        this.prevButtonNode = undefined;\n        this.nextButtonNode = undefined;\n    }\n\n    public getNode() {\n        if (!this.calendarNode) {\n            return document.createElement('div');\n        }\n\n        return this.calendarNode;\n    }\n\n    /**\n     * Задать дефолтное значение выбранной даты.\n     *\n     * - Принимает Date | ISO-строку.\n     * - Нормализует дату (конец дня), чтобы сравнения с currentDate работали стабильно.\n     * - Если дата находится в прошлом относительно currentDate — ставит currentDate.\n     * - Перерисовывает календарь.\n     *\n     * @param value Дата по умолчанию (Date или ISO string)\n     */\n    public setDefaultValue(value: Date | string): void {\n        const parsed = typeof value === 'string' ? new Date(value) : new Date(value);\n\n        if (Number.isNaN(parsed.getTime())) {\n            return;\n        }\n\n        parsed.setHours(23, 59, 59, 999);\n\n        const nextSelected = parsed < this.currentDate ? new Date(this.currentDate) : parsed;\n\n        const year = nextSelected.getFullYear();\n        const month = nextSelected.getMonth();\n        const day = nextSelected.getDate();\n\n        const lastDayOfMonth = new Date(year, month + 1, 0, 23, 59, 59, 999).getDate();\n        const safeDay = Math.min(day, lastDayOfMonth);\n\n        this.selectedDate = new Date(year, month, safeDay, 23, 59, 59, 999);\n\n        if (this.calendarNode) {\n            this.updateDatePicker();\n        }\n    }\n\n    /**\n     * Нормализует дату к первому дню месяца (00:00:00.000)\n     */\n    private getMonthStart(date: Date): Date {\n        return new Date(date.getFullYear(), date.getMonth(), 1, 0, 0, 0, 0);\n    }\n\n    /**\n     * Синхронизирует состояние кнопки \"назад\":\n     * блокируем, если предыдущий месяц < текущего месяца.\n     */\n    private syncPrevButtonState(): void {\n        if (!this.prevButtonNode) {\n            return;\n        }\n\n        const currentMonthStart = this.getMonthStart(this.currentDate);\n        const prevMonthStart = this.getMonthStart(this.selectedDate);\n        prevMonthStart.setMonth(prevMonthStart.getMonth() - 1);\n\n        const disabled = prevMonthStart < currentMonthStart;\n\n        this.prevButtonNode.disabled = disabled;\n\n        const prevImg = document.createElement('img');\n\n        if (disabled) {\n            prevImg.src = prevDisabledSvg;\n\n            this.prevButtonNode.replaceChildren(prevImg);\n        } else {\n            prevImg.src = prevSvg;\n\n            this.prevButtonNode.replaceChildren(prevImg);\n        }\n    }\n\n    /**\n     * Возвращает недели месяца с привязанными числами дней\n     * @param {number} year - год\n     * @param {number} month - месяц\n     * @returns {(Date | null)[][]} массив недель\n     */\n    private getMonthWeeks(year: number, month: number): (Date | null)[][] {\n        const weeks = [];\n        let week = [];\n\n        const firstDay = new Date(year, month, 1);\n        const lastDay = new Date(year, month + 1, 0);\n\n        firstDay.setHours(0, 0, 0, 0);\n        lastDay.setHours(23, 59, 59, 999);\n\n        // День недели первого дня (0 = понедельник)\n        const startDay = (firstDay.getDay() + 6) % 7;\n\n        // Пустые ячейки до первого дня месяца\n        for (let i = 0; i < startDay; i++) {\n            week.push(null);\n        }\n\n        for (let day = 1; day <= lastDay.getDate(); day++) {\n            const date = new Date(year, month, day);\n            date.setHours(23, 59, 59, 999);\n\n            week.push(date);\n\n            if (week.length === 7) {\n                weeks.push(week);\n                week = [];\n            }\n        }\n\n        // Хвост недели\n        if (week.length > 0) {\n            while (week.length < 7) {\n                week.push(null);\n            }\n            weeks.push(week);\n        }\n\n        return weeks;\n    }\n\n    private updateDatePicker() {\n        if (!this.calendarNode || !this.datePickerNode) {\n            return;\n        }\n\n        const calendarTitle = this.calendarNode.querySelector('.calendar__title');\n        const spanTitle1 = document.createElement('h3');\n        const spanTitle2 = document.createElement('h3');\n\n        spanTitle1.textContent = this.selectedDate.toLocaleString('ru-RU', { month: 'long' });\n        spanTitle2.textContent = this.selectedDate.toLocaleString('ru-RU', { year: 'numeric' });\n\n        calendarTitle?.replaceChildren(spanTitle1, spanTitle2);\n\n        const mountsData = this.getMonthWeeks(this.selectedDate.getFullYear(), this.selectedDate.getMonth());\n        const newDatePicker = this.getDatePickerNode(mountsData);\n\n        this.datePickerNode.replaceWith(newDatePicker);\n        this.datePickerNode = newDatePicker;\n\n        this.syncPrevButtonState();\n    }\n\n    private handleNextMount() {\n        const currentYear = this.selectedDate.getFullYear();\n        const currentMount = this.selectedDate.getMonth();\n\n        this.selectedDate.setDate(1);\n\n        if (currentMount === 11) {\n            this.selectedDate.setFullYear(currentYear + 1);\n            this.selectedDate.setMonth(0);\n        } else {\n            this.selectedDate.setMonth(this.selectedDate.getMonth() + 1);\n        }\n\n        this.updateDatePicker();\n    }\n\n    private handlePrevMount() {\n        const currentYear = this.selectedDate.getFullYear();\n        const currentMount = this.selectedDate.getMonth();\n\n        this.selectedDate.setDate(1);\n\n        if (currentMount === 0) {\n            this.selectedDate.setFullYear(currentYear - 1);\n            this.selectedDate.setMonth(11);\n        } else {\n            this.selectedDate.setMonth(this.selectedDate.getMonth() - 1);\n        }\n\n        this.updateDatePicker();\n    }\n\n    private getDatePickerNode(mountsData: (Date | null)[][]) {\n        const datePicker = document.createElement('div');\n        datePicker.classList.add('date-picker');\n\n        const weekNode = document.createElement('div');\n        weekNode.classList.add('date-picker__week');\n\n        for (let i = 0; i < 7; i++) {\n            const dayName = document.createElement('span');\n            dayName.classList.add('date-picker__day-name');\n            dayName.textContent = ['пн', 'вт', 'ср', 'чт', 'пт', 'сб', 'вс'][i];\n\n            weekNode.appendChild(dayName);\n        }\n\n        datePicker.appendChild(weekNode);\n\n        mountsData.forEach((week) => {\n            const weekNode = document.createElement('div');\n            weekNode.classList.add('date-picker__week');\n\n            week.forEach((day) => {\n                const dayNode = document.createElement('button');\n\n                dayNode.classList.add('date-picker__day');\n                dayNode.type = 'button';\n\n                if (day) {\n                    dayNode.value = day.toISOString().toString();\n                    dayNode.textContent = this.formatterDay.format(day);\n                    dayNode.dataset.value = `до ${this.formatterMount.format(day)}`;\n\n                    if (day < this.currentDate) {\n                        dayNode.classList.add('date-picker__day--no-active');\n                        dayNode.tabIndex = -1;\n                        dayNode.disabled = true;\n                    }\n                } else {\n                    dayNode.classList.add('date-picker__day--no-active');\n                    dayNode.tabIndex = -1;\n                    dayNode.disabled = true;\n                }\n\n                weekNode.appendChild(dayNode);\n            });\n\n            datePicker.appendChild(weekNode);\n        });\n\n        return datePicker;\n    }\n\n    private createCalendarNode() {\n        const calendar = document.createElement('div');\n        calendar.classList.add('calendar');\n\n        const calendarBody = document.createElement('div');\n        calendarBody.classList.add('calendar__body');\n\n        const calendarTitle = document.createElement('div');\n        const spanTitle1 = document.createElement('h3');\n        const spanTitle2 = document.createElement('h3');\n\n        calendarTitle.classList.add('calendar__title');\n        spanTitle1.textContent = this.selectedDate.toLocaleString('ru-RU', { month: 'long' });\n        spanTitle2.textContent = this.selectedDate.toLocaleString('ru-RU', { year: 'numeric' });\n\n        calendarTitle.appendChild(spanTitle1);\n        calendarTitle.appendChild(spanTitle2);\n\n        calendarBody.appendChild(calendarTitle);\n\n        const mountsData = this.getMonthWeeks(this.selectedDate.getFullYear(), this.selectedDate.getMonth());\n\n        const datePicker = this.getDatePickerNode(mountsData);\n\n        calendarBody.appendChild(datePicker);\n\n        calendar.appendChild(calendarBody);\n\n        const prev = document.createElement('button');\n        const next = document.createElement('button');\n        const prevImg = document.createElement('img');\n        const nextImg = document.createElement('img');\n\n        prev.classList.add('calendar__btn', 'calendar__prev');\n        next.classList.add('calendar__btn', 'calendar__next');\n\n        prev.type = 'button';\n        next.type = 'button';\n\n        prevImg.src = prevSvg;\n        nextImg.src = nextSvg;\n\n        prev.appendChild(prevImg);\n        next.appendChild(nextImg);\n\n        calendar.appendChild(prev);\n        calendar.appendChild(next);\n\n        this.prevButtonNode = prev;\n        this.nextButtonNode = next;\n        this.datePickerNode = datePicker;\n        this.calendarNode = calendar;\n\n        this.syncPrevButtonState();\n\n        prev.addEventListener('click', this.handlePrevMount.bind(this));\n        next.addEventListener('click', this.handleNextMount.bind(this));\n    }\n}\n","export function onlyNumbersFormatter(evt: Event) {\n    const target = evt.target as HTMLInputElement;\n\n    target.value = target.value.replace(/[^0-9]/g, '');\n}\n\nexport function currencyFormatterEvent(evt: Event): void {\n    const target = evt.target as HTMLInputElement;\n\n    target.value = new Intl.NumberFormat('ru-RU', {\n        style: 'currency',\n        currency: 'RUB',\n        maximumFractionDigits: 0,\n    }).format(Number(target.value));\n}\n\nexport function currencyFormatter(value: number): string {\n    return new Intl.NumberFormat('ru-RU', {\n        style: 'currency',\n        currency: 'RUB',\n        maximumFractionDigits: 0,\n    }).format(value);\n}\n\nexport function numberFormatterEvent(evt: Event): void {\n    const target = evt.target as HTMLInputElement;\n\n    target.value = new Intl.NumberFormat('ru-RU', {\n        style: 'decimal',\n        maximumFractionDigits: 0,\n    }).format(Number(target.value));\n}\n\nexport function numberFormatter(value: string): number {\n    const reg = /\\D/gi;\n\n    return Number(value.replace(reg, ''));\n}\n","import { Calendar } from '../components/calendar/calendar.ts';\nimport { DateSelector } from '../components/calendar/dateSelector.ts';\nimport { SYSTEM_EVENTS, SYSTEM_NAME_SPACE } from '../constant.ts';\nimport { IEvents } from '../events/events.ts';\nimport { IAccountModel } from '../models/account/IAccount.ts';\nimport { IBalance } from '../models/balance/IBalance.ts';\nimport { differentDateInDay } from '../utils/date/dateUtils.ts';\nimport {\n    currencyFormatter,\n    currencyFormatterEvent,\n    numberFormatter,\n    onlyNumbersFormatter,\n} from '../utils/formatters/inputFormatter.ts';\nimport { IMainView } from '../views/types.ts';\n\nimport { IBalancePresenter } from './types.ts';\n\nexport class BalancePresenter implements IBalancePresenter {\n    private readonly events: IEvents;\n    private readonly accountModel: IAccountModel;\n    private readonly view: IMainView;\n    private cardNode: HTMLElement | undefined = undefined;\n\n    constructor(accountModel: IAccountModel, view: IMainView, events: IEvents) {\n        this.accountModel = accountModel;\n        this.view = view;\n        this.events = events;\n\n        this.events.on(SYSTEM_EVENTS.BALANCE_UPDATED, () => {\n            this.balanceUpdate();\n        });\n    }\n\n    public init() {\n        const balance: IBalance = this.accountModel.getBalance();\n\n        const cardBlock = document.createElement('div');\n        cardBlock.classList.add('card-block');\n\n        const cardDescription = document.createElement('div');\n        cardDescription.classList.add('card__title');\n\n        const cardDescSpan1 = document.createElement('h3');\n        cardDescSpan1.classList.add('card__title-left');\n        cardDescSpan1.textContent = 'Общий баланс';\n\n        const cardDescSpan2 = document.createElement('span');\n        cardDescSpan2.classList.add('card__title-right');\n        cardDescSpan2.textContent = `${currencyFormatter(balance.dayLimit)} в день`;\n\n        cardDescription.appendChild(cardDescSpan1);\n        cardDescription.appendChild(cardDescSpan2);\n\n        cardBlock.appendChild(cardDescription);\n\n        const cardBody = document.createElement('div');\n        cardBody.classList.add('card__body');\n\n        const balanceBlock = document.createElement('div');\n        balanceBlock.classList.add('balance-block');\n\n        const differentDayToEnd = differentDateInDay(new Date(balance.id), new Date(balance.endDate));\n\n        const balanceBlockSpan1 = document.createElement('h1');\n        balanceBlockSpan1.classList.add('balance-block__balance');\n        balanceBlockSpan1.textContent = currencyFormatter(balance.value);\n\n        const balanceBlockSpan2 = document.createElement('span');\n        balanceBlockSpan2.classList.add('balance-block__day');\n        balanceBlockSpan2.textContent = `на ${differentDayToEnd} дней`;\n\n        balanceBlock.appendChild(balanceBlockSpan1);\n        balanceBlock.appendChild(balanceBlockSpan2);\n\n        cardBody.appendChild(balanceBlock);\n\n        const balanceChangeButton = document.createElement('button');\n        balanceChangeButton.classList.add('btn', 'balance-block__change-button');\n        balanceChangeButton.textContent = 'Изменить';\n\n        cardBody.appendChild(balanceChangeButton);\n\n        cardBlock.appendChild(cardBody);\n\n        balanceChangeButton.addEventListener('click', this.handleChangeBalance.bind(this));\n\n        this.cardNode = cardBlock;\n        this.view.addChildWithKey(SYSTEM_NAME_SPACE.BALANCE_BLOCK, cardBlock);\n\n        this.destroyData = () => {\n            balanceChangeButton.removeEventListener('click', this.handleChangeBalance.bind(this));\n\n            this.view.unmount(SYSTEM_NAME_SPACE.BALANCE_BLOCK);\n        };\n    }\n\n    public destroy() {\n        this.destroyData();\n    }\n\n    public initOverflow() {\n        this.view.unmount(SYSTEM_NAME_SPACE.BALANCE_BLOCK);\n\n        const balance: IBalance = this.accountModel.getBalance();\n\n        const cardBlock = document.createElement('div');\n        cardBlock.classList.add('card-block', 'card-block--overflow');\n\n        const cardDescription = document.createElement('div');\n        cardDescription.classList.add('card__title');\n\n        const cardDescSpan1 = document.createElement('h3');\n        cardDescSpan1.classList.add('card__title-left');\n        cardDescSpan1.textContent = 'Общий баланс';\n\n        const cardDescSpan2 = document.createElement('span');\n        cardDescSpan2.classList.add('card__title-right');\n        cardDescSpan2.textContent = `${currencyFormatter(balance.dayLimit)} в день`;\n\n        cardDescription.appendChild(cardDescSpan1);\n        cardDescription.appendChild(cardDescSpan2);\n\n        cardBlock.appendChild(cardDescription);\n\n        const cardBody = document.createElement('div');\n        cardBody.classList.add('card__body');\n\n        const form = document.createElement('form');\n        form.name = 'change-balance';\n        form.classList.add('form', 'form--change-balance');\n\n        /* label.input */\n        const balanceLabel = document.createElement('label');\n        balanceLabel.classList.add('input');\n\n        const balanceTitle = document.createElement('span');\n        balanceTitle.classList.add('input__title', 'caption');\n        balanceTitle.textContent = 'Ваш баланс';\n\n        const balanceInput = document.createElement('input');\n        balanceInput.name = 'balance';\n        balanceInput.classList.add('input__input');\n        balanceInput.disabled = true;\n        balanceInput.placeholder = 'Ваш баланс';\n        balanceInput.value = currencyFormatter(balance.value);\n\n        balanceLabel.append(balanceTitle, balanceInput);\n\n        const upBalanceLabel = document.createElement('label');\n        upBalanceLabel.classList.add('input');\n\n        const upBalanceTitle = document.createElement('span');\n        upBalanceTitle.classList.add('input__title', 'caption');\n        upBalanceTitle.textContent = 'Пополнить';\n\n        const upBalanceInput = document.createElement('input');\n        upBalanceInput.name = 'up-balance';\n        upBalanceInput.classList.add('input__input');\n        upBalanceInput.placeholder = 'Пополнить';\n        upBalanceInput.value = currencyFormatter(0);\n\n        upBalanceInput.addEventListener('input', onlyNumbersFormatter);\n        upBalanceInput.addEventListener('change', currencyFormatterEvent);\n\n        upBalanceLabel.append(upBalanceTitle, upBalanceInput);\n\n        const dateSelector = new DateSelector();\n        const calendarObj = new Calendar(\n            {\n                name: 'term',\n                title: 'На срок',\n                placeholder: 'Выбор даты',\n            },\n            dateSelector\n        );\n\n        calendarObj.setValue(balance.endDate);\n\n        const calcButton = document.createElement('button');\n        calcButton.classList.add('btn', 'btn--primary', 'form__submit--change-balance');\n        calcButton.textContent = 'сохранить';\n        calcButton.type = 'submit';\n\n        form.append(balanceLabel, upBalanceLabel, calendarObj.getNode(), calcButton);\n        cardBody.appendChild(form);\n\n        cardBlock.appendChild(cardBody);\n\n        form.addEventListener('submit', this.handleSubmitForm.bind(this));\n\n        this.view.addChildWithKey(SYSTEM_NAME_SPACE.BALANCE_PAGE, cardBlock);\n\n        this.overflowDestroyData = () => {\n            upBalanceInput.removeEventListener('input', onlyNumbersFormatter);\n            upBalanceInput.removeEventListener('change', currencyFormatterEvent);\n            form.removeEventListener('submit', this.handleSubmitForm.bind(this));\n\n            this.view.unmount(SYSTEM_NAME_SPACE.BALANCE_PAGE);\n        };\n    }\n\n    public overflowDestroy() {\n        this.overflowDestroyData();\n    }\n\n    private async handleSubmitForm(event: Event) {\n        event.preventDefault();\n\n        if (!this.cardNode) {\n            throw new Error('Card node is not defined');\n        }\n\n        const form = this.cardNode.querySelector('form');\n\n        if (!form) {\n            throw new Error('Form is not defined');\n        }\n\n        const upBalance: Element | RadioNodeList | null = form.elements.namedItem('up-balance');\n        const term: Element | RadioNodeList | null = form.elements.namedItem('term');\n\n        if (!upBalance || !term) {\n            return;\n        }\n\n        if ('value' in upBalance && 'value' in term) {\n            await this.accountModel.upBalance(numberFormatter(upBalance.value), new Date(term.value));\n        }\n\n        this.events.emit(SYSTEM_EVENTS.CHANGE_PAGE, { page: SYSTEM_NAME_SPACE.MAIN_PAGE });\n    }\n\n    private handleChangeBalance(event: Event) {\n        event.preventDefault();\n\n        this.events.emit(SYSTEM_EVENTS.CHANGE_PAGE, { page: SYSTEM_NAME_SPACE.BALANCE_PAGE });\n    }\n\n    private balanceUpdate() {\n        if (!this.cardNode) {\n            throw new Error('Card node is not defined');\n        }\n\n        const balance: IBalance = this.accountModel.getBalance();\n\n        const balanceNode = this.cardNode.querySelector('.card__title-left');\n        const dayLimitNode = this.cardNode.querySelector('.card__title-right');\n\n        if (!balanceNode || !dayLimitNode) {\n            throw new Error('Balance/Day-limit node is not defined');\n        }\n\n        balanceNode.textContent = currencyFormatter(balance.value);\n        dayLimitNode.textContent = currencyFormatter(balance.dayLimit);\n    }\n\n    private destroyData: () => void = () => {};\n    private overflowDestroyData: () => void = () => {};\n}\n","import { SYSTEM_EVENTS, SYSTEM_NAME_SPACE } from '../constant.ts';\nimport { IEvents } from '../events/events.ts';\nimport { IAccountModel, IBalanceLimit } from '../models/account/IAccount.ts';\nimport { IBalance } from '../models/balance/IBalance.ts';\nimport { getCurrentDate } from '../utils/date/dateUtils.ts';\nimport { ITransactionCreate } from '../utils/db/types.ts';\nimport {\n    currencyFormatter,\n    currencyFormatterEvent,\n    numberFormatter,\n    onlyNumbersFormatter,\n} from '../utils/formatters/inputFormatter.ts';\nimport { IMainView } from '../views/types.ts';\n\nimport { IDayLimitPresenter } from './types.ts';\n\nexport class DayLimitPresenter implements IDayLimitPresenter {\n    private readonly events: IEvents;\n    private readonly accountModel: IAccountModel;\n    private readonly view: IMainView;\n    private cardNode: HTMLElement | undefined = undefined;\n\n    constructor(accountModel: IAccountModel, view: IMainView, events: IEvents) {\n        this.accountModel = accountModel;\n        this.view = view;\n        this.events = events;\n\n        this.events.on(SYSTEM_EVENTS.BALANCE_UPDATED, () => {\n            this.balanceUpdate();\n            this.commentUpdate();\n        });\n    }\n\n    public init() {\n        const balance: IBalance = this.accountModel.getBalance();\n\n        const cardBlock = document.createElement('div');\n        cardBlock.classList.add('card-block');\n\n        const cardDescription = document.createElement('div');\n        cardDescription.classList.add('card__title');\n\n        const cardDescSpan1 = document.createElement('h3');\n        cardDescSpan1.classList.add('card__title-left');\n        cardDescSpan1.textContent = 'На сегодня доступно';\n\n        cardDescription.appendChild(cardDescSpan1);\n\n        cardBlock.appendChild(cardDescription);\n\n        const cardBody = document.createElement('div');\n        cardBody.classList.add('card__body');\n\n        const balanceBlock = document.createElement('div');\n        balanceBlock.classList.add('balance-block');\n\n        const balanceBlockH1 = document.createElement('h1');\n        balanceBlockH1.classList.add('balance-block__balance');\n\n        const balanceBlockSpan1 = document.createElement('span');\n        balanceBlockSpan1.classList.add('balance-block__balance--wasted');\n        balanceBlockSpan1.textContent = currencyFormatter(balance.wasted);\n\n        const balanceBlockSpan2 = document.createElement('span');\n        balanceBlockSpan2.classList.add('balance-block__balance--available');\n        balanceBlockSpan2.textContent = currencyFormatter(balance.dayLimit);\n\n        balanceBlockH1.appendChild(balanceBlockSpan1);\n        balanceBlockH1.appendChild(balanceBlockSpan2);\n\n        balanceBlock.appendChild(balanceBlockH1);\n\n        cardBody.appendChild(balanceBlock);\n\n        const wastedComment = document.createElement('p');\n        wastedComment.classList.add('balance-block__wasted-comment');\n\n        cardBody.appendChild(wastedComment);\n\n        const form = document.createElement('form');\n        form.name = 'welcome';\n        form.classList.add('form', 'form--day-limit');\n\n        /* label.input */\n        const balanceLabel = document.createElement('label');\n        balanceLabel.classList.add('input');\n\n        const balanceTitle = document.createElement('span');\n        balanceTitle.classList.add('input__title', 'caption');\n        balanceTitle.textContent = 'Введите трату';\n\n        const balanceInput = document.createElement('input');\n        balanceInput.name = 'wasted';\n        balanceInput.classList.add('input__input');\n        balanceInput.placeholder = '0 ₽';\n\n        balanceInput.addEventListener('input', onlyNumbersFormatter);\n        balanceInput.addEventListener('change', currencyFormatterEvent);\n\n        balanceLabel.append(balanceTitle, balanceInput);\n\n        const balanceChangeButton = document.createElement('button');\n        balanceChangeButton.classList.add('btn', 'btn--primary', 'balance-block__change-button');\n        balanceChangeButton.textContent = 'Сохранить';\n        balanceChangeButton.type = 'submit';\n\n        form.append(balanceLabel, balanceChangeButton);\n        cardBody.appendChild(form);\n\n        cardBlock.appendChild(cardBody);\n\n        form.addEventListener('submit', async (event) => {\n            event.preventDefault();\n\n            const wasted: Element | RadioNodeList | null = form.elements.namedItem('wasted');\n\n            if (!wasted) {\n                return;\n            }\n\n            if ('value' in wasted) {\n                const newTransaction: ITransactionCreate = {\n                    value: numberFormatter(wasted.value),\n                    date: getCurrentDate().toISOString(),\n                };\n\n                await this.accountModel.addTransaction(newTransaction);\n\n                balanceInput.value = '';\n                balanceInput.placeholder = '0 ₽';\n            }\n        });\n\n        this.cardNode = cardBlock;\n\n        this.balanceUpdate();\n        this.commentUpdate();\n\n        this.view.addChildWithKey(SYSTEM_NAME_SPACE.DAY_LIMIT_BLOCK, cardBlock);\n\n        this.destroyData = () => {\n            this.cardNode?.classList.toggle('card-block--hidden');\n\n            this.view.unmount(SYSTEM_NAME_SPACE.DAY_LIMIT_BLOCK);\n\n            balanceInput.removeEventListener('input', onlyNumbersFormatter);\n            balanceInput.removeEventListener('change', currencyFormatterEvent);\n        };\n    }\n\n    public destroy() {\n        this.destroyData();\n    }\n\n    private balanceUpdate(): void {\n        if (!this.cardNode) {\n            throw new Error('Card node is not defined');\n        }\n\n        const balanceBlockWaste = this.cardNode.querySelector('.balance-block__balance--wasted');\n        const balanceBlockAviable = this.cardNode.querySelector('.balance-block__balance--available');\n\n        if (!balanceBlockWaste || !balanceBlockAviable) {\n            throw new Error('Balance block is not defined');\n        }\n\n        const remainedBalanceDay = this.accountModel.getBalanceLimit();\n\n        balanceBlockAviable.textContent = currencyFormatter(remainedBalanceDay.limit);\n        balanceBlockWaste.textContent = currencyFormatter(remainedBalanceDay.remained);\n        balanceBlockWaste.classList.remove();\n\n        if (remainedBalanceDay.remained >= 0) {\n            balanceBlockWaste.classList.add('balance-block__balance--remained--success');\n        } else {\n            balanceBlockWaste.classList.add('balance-block__balance--remained--error');\n        }\n    }\n\n    private commentUpdate(): void {\n        if (!this.cardNode) {\n            throw new Error('Card node is not defined');\n        }\n\n        const commentBlock = this.cardNode.querySelector('.balance-block__wasted-comment');\n\n        if (!commentBlock) {\n            throw new Error('Comment block is not defined');\n        }\n\n        const balanceLimit: IBalanceLimit = this.accountModel.getBalanceLimit();\n\n        if (balanceLimit.inLimit) {\n            commentBlock.textContent = '🎉 Отлично справились — сегодня вы в пределах лимита!';\n        } else {\n            commentBlock.textContent = '❌ Вы превысили лимит на сегодня!';\n        }\n    }\n\n    private destroyData: () => void = () => {};\n}\n","import { SYSTEM_EVENTS, SYSTEM_NAME_SPACE } from '../constant.ts';\nimport { IEvents } from '../events/events.ts';\nimport { IAccountModel } from '../models/account/IAccount.ts';\nimport { IBalance } from '../models/balance/IBalance.ts';\nimport { ITransaction } from '../models/transaction/ITransaction.ts';\nimport { dateFormatter, dateFullFormatter } from '../utils/formatters/dateFormatter.ts';\nimport { currencyFormatter } from '../utils/formatters/inputFormatter.ts';\nimport { IMainView } from '../views/types.ts';\n\nimport { ITransactionPresenter } from './types.ts';\n\nexport class TransactionPresenter implements ITransactionPresenter {\n    private readonly events: IEvents;\n    private readonly accountModel: IAccountModel;\n    private readonly view: IMainView;\n    private cardNode: HTMLElement | undefined = undefined;\n\n    constructor(accountModel: IAccountModel, view: IMainView, events: IEvents) {\n        this.accountModel = accountModel;\n        this.view = view;\n        this.events = events;\n\n        this.events.on(SYSTEM_EVENTS.TRANSACTION_UPDATED, () => {\n            this.transactionsListUpdated(false);\n        });\n    }\n\n    public init() {\n        const balance: IBalance = this.accountModel.getBalance();\n\n        const cardBlock = document.createElement('div');\n        cardBlock.classList.add('card-block');\n\n        const cardDescription = document.createElement('div');\n        cardDescription.classList.add('card__title', 'card__title--wasted');\n\n        const cardDescSpan = document.createElement('h2');\n        cardDescSpan.classList.add('card__title-left');\n        cardDescSpan.textContent = 'История расходов';\n\n        cardDescription.appendChild(cardDescSpan);\n\n        cardBlock.appendChild(cardDescription);\n\n        const cardBody = document.createElement('div');\n        cardBody.classList.add('card__body');\n\n        const cardAvgWastedSpan = document.createElement('span');\n        cardAvgWastedSpan.classList.add('card__body__title');\n        cardAvgWastedSpan.textContent = `Средние траты в день: ${currencyFormatter(balance.avgDayWasted)}`;\n\n        cardBody.appendChild(cardAvgWastedSpan);\n\n        const transactionsList = document.createElement('div');\n        transactionsList.classList.add('transactions-list');\n\n        cardBody.appendChild(transactionsList);\n\n        const viewHistoryButton = document.createElement('button');\n        viewHistoryButton.classList.add('btn');\n        viewHistoryButton.textContent = 'Смотреть всю историю';\n\n        cardBody.appendChild(viewHistoryButton);\n\n        cardBlock.appendChild(cardBody);\n\n        viewHistoryButton.addEventListener('click', this.handleViewFullHistory.bind(this));\n\n        this.cardNode = cardBlock;\n\n        this.transactionsListUpdated(false);\n\n        this.view.addChildWithKey(SYSTEM_NAME_SPACE.TRANSACTION_BLOCK, cardBlock);\n\n        this.destroyData = () => {\n            viewHistoryButton.removeEventListener('click', this.handleViewFullHistory.bind(this));\n\n            this.view.unmount(SYSTEM_NAME_SPACE.TRANSACTION_BLOCK);\n        };\n    }\n\n    public destroy() {\n        this.destroyData();\n    }\n\n    public initOverflow(): void {\n        this.view.unmount(SYSTEM_NAME_SPACE.TRANSACTION_BLOCK);\n\n        const balance: IBalance = this.accountModel.getBalance();\n\n        const cardBlock = document.createElement('div');\n        cardBlock.classList.add('card-block', 'card-block--overflow');\n\n        const cardDescription = document.createElement('div');\n        cardDescription.classList.add('card__title', 'card__title--wasted');\n\n        const cardDescSpan = document.createElement('h2');\n        cardDescSpan.classList.add('card__title-left');\n        cardDescSpan.textContent = 'История расходов';\n\n        cardDescription.appendChild(cardDescSpan);\n\n        cardBlock.appendChild(cardDescription);\n\n        const cardBody = document.createElement('div');\n        cardBody.classList.add('card__body');\n\n        const cardAvgWastedSpan = document.createElement('span');\n        cardAvgWastedSpan.classList.add('card__body__title');\n        cardAvgWastedSpan.textContent = `Средние траты в день: ${currencyFormatter(balance.avgDayWasted)}`;\n\n        cardBody.appendChild(cardAvgWastedSpan);\n\n        const transactionsList = document.createElement('div');\n        transactionsList.classList.add('transactions-list', 'transactions-list--full');\n\n        cardBody.appendChild(transactionsList);\n\n        const moveToMainPageButton = document.createElement('button');\n        moveToMainPageButton.classList.add('btn');\n        moveToMainPageButton.textContent = 'Вернуться на главную';\n\n        cardBody.appendChild(moveToMainPageButton);\n\n        cardBlock.appendChild(cardBody);\n\n        moveToMainPageButton.addEventListener('click', this.handelMoveToMainPage.bind(this));\n\n        this.cardNode = cardBlock;\n\n        this.transactionsListUpdated(true);\n\n        this.view.addChildWithKey(SYSTEM_NAME_SPACE.TRANSACTION_BLOCK, cardBlock);\n\n        this.destroyData = () => {\n            moveToMainPageButton.removeEventListener('click', this.handelMoveToMainPage.bind(this));\n\n            this.view.unmount(SYSTEM_NAME_SPACE.TRANSACTION_BLOCK);\n        };\n    }\n\n    public overflowDestroy() {\n        this.overflowDestroyData();\n    }\n\n    private handleViewFullHistory(event: Event) {\n        event.preventDefault();\n\n        this.events.emit(SYSTEM_EVENTS.CHANGE_PAGE, { page: SYSTEM_NAME_SPACE.TRANSACTION_PAGE });\n    }\n\n    private handelMoveToMainPage(event: Event) {\n        event.preventDefault();\n\n        this.events.emit(SYSTEM_EVENTS.CHANGE_PAGE, { page: SYSTEM_NAME_SPACE.MAIN_PAGE });\n    }\n\n    private transactionsListUpdated(fullLoad: boolean) {\n        if (!this.cardNode) {\n            throw new Error('Card node is not defined');\n        }\n\n        const transactionsListNode = this.cardNode.querySelector('.transactions-list');\n\n        if (!transactionsListNode) {\n            throw new Error('Transactions list node is not defined');\n        }\n\n        transactionsListNode.replaceChildren();\n\n        let transactions: ITransaction[] = this.accountModel.getTransactions();\n\n        if (!fullLoad) {\n            transactions = transactions.slice(0, 3);\n        }\n\n        transactions.forEach((transaction) => {\n            const transactionCard = document.createElement('div');\n            transactionCard.classList.add('transaction-card');\n\n            const transactionCardTitle = document.createElement('h3');\n            transactionCardTitle.classList.add('transaction-card__value');\n            transactionCardTitle.textContent = currencyFormatter(transaction.value);\n\n            const transactionCardValue = document.createElement('span');\n            transactionCardValue.classList.add('transaction-card__date');\n\n            if (fullLoad) {\n                transactionCardValue.textContent = dateFullFormatter(new Date(transaction.date));\n            } else {\n                transactionCardValue.textContent = dateFormatter(new Date(transaction.date));\n            }\n\n            transactionCard.appendChild(transactionCardTitle);\n            transactionCard.appendChild(transactionCardValue);\n\n            transactionsListNode.appendChild(transactionCard);\n        });\n    }\n\n    private destroyData: () => void = () => {};\n    private overflowDestroyData: () => void = () => {};\n}\n","import { Calendar } from '../components/calendar/calendar.ts';\nimport { DateSelector } from '../components/calendar/dateSelector.ts';\nimport { SYSTEM_EVENTS, SYSTEM_NAME_SPACE } from '../constant.ts';\nimport { IEvents } from '../events/events.ts';\nimport { IAccountModel } from '../models/account/IAccount.ts';\nimport { currencyFormatterEvent, numberFormatter, onlyNumbersFormatter } from '../utils/formatters/inputFormatter.ts';\nimport { IMainView } from '../views/types.ts';\n\nimport { IWelcomePagePresenter } from './types.ts';\n\nexport class WelcomePagePresenter implements IWelcomePagePresenter {\n    private readonly events: IEvents;\n    private readonly accountModel: IAccountModel;\n    private readonly view: IMainView;\n    private cardNode: HTMLElement | undefined = undefined;\n\n    constructor(accountModel: IAccountModel, view: IMainView, events: IEvents) {\n        this.accountModel = accountModel;\n        this.view = view;\n        this.events = events;\n    }\n\n    init() {\n        const cardBlock = document.createElement('div');\n        cardBlock.classList.add('card-block', 'card-block--welcome');\n\n        const title = document.createElement('h1');\n        title.classList.add('card__title');\n        title.textContent = 'Начнём!';\n\n        const body = document.createElement('div');\n        body.classList.add('card__body');\n\n        const form = document.createElement('form');\n        form.name = 'welcome';\n        form.classList.add('form', 'form--welcome');\n\n        /* label.input */\n        const balanceLabel = document.createElement('label');\n        balanceLabel.classList.add('input');\n\n        const balanceTitle = document.createElement('span');\n        balanceTitle.classList.add('input__title', 'caption');\n        balanceTitle.textContent = 'Укажите баланс';\n\n        const balanceInput = document.createElement('input');\n        balanceInput.name = 'start-balance';\n        balanceInput.classList.add('input__input');\n        balanceInput.placeholder = 'Стартовый баланс';\n\n        balanceInput.addEventListener('input', onlyNumbersFormatter);\n        balanceInput.addEventListener('change', currencyFormatterEvent);\n\n        balanceLabel.append(balanceTitle, balanceInput);\n\n        const dateSelector = new DateSelector();\n        const calendarObj = new Calendar(\n            {\n                name: 'term',\n                title: 'На срок',\n                placeholder: 'Выбор даты',\n            },\n            dateSelector\n        );\n\n        const calcButton = document.createElement('button');\n        calcButton.classList.add('btn', 'btn--primary', 'form__submit--welcome');\n        calcButton.textContent = 'Рассчитать';\n        calcButton.type = 'submit';\n\n        form.append(balanceLabel, calendarObj.getNode(), calcButton);\n        body.appendChild(form);\n\n        cardBlock.append(title, body);\n\n        form.addEventListener('submit', this.handleSubmitForm.bind(this));\n\n        this.cardNode = cardBlock;\n        this.view.addChildWithKey(SYSTEM_NAME_SPACE.WELCOME_PAGE, cardBlock);\n\n        this.destroyData = () => {\n            balanceInput.removeEventListener('input', onlyNumbersFormatter);\n            balanceInput.removeEventListener('change', currencyFormatterEvent);\n            form.removeEventListener('submit', this.handleSubmitForm.bind(this));\n\n            dateSelector.destroy();\n            calendarObj.destroy();\n\n            this.view.unmount(SYSTEM_NAME_SPACE.WELCOME_PAGE);\n        };\n    }\n\n    destroy() {\n        this.destroyData();\n    }\n\n    private async handleSubmitForm(event: Event) {\n        event.preventDefault();\n\n        if (!this.cardNode) {\n            throw new Error('Card node is not defined');\n        }\n\n        const form = this.cardNode.querySelector('form');\n\n        if (!form) {\n            throw new Error('Form is not defined');\n        }\n\n        const startBalance: Element | RadioNodeList | null = form.elements.namedItem('start-balance');\n        const term: Element | RadioNodeList | null = form.elements.namedItem('term');\n\n        if (!startBalance || !term) {\n            return;\n        }\n\n        if ('value' in startBalance && 'value' in term) {\n            await this.accountModel.initBalance(numberFormatter(startBalance.value), new Date(term.value));\n\n            this.events.emit(SYSTEM_EVENTS.INIT_BALANCE);\n        }\n    }\n\n    private destroyData: () => void = () => {};\n}\n","import { IMainView, MountKey } from './types.ts';\n\nexport class MainView implements IMainView {\n    private rootNode: HTMLElement | null = document.getElementById('app');\n    private pageNode: HTMLElement;\n    private contentNode: HTMLElement;\n    private childrenByKey: Map<MountKey, HTMLElement> = new Map();\n\n    constructor() {\n        if (!this.rootNode) {\n            throw new Error('App root element #app not found');\n        }\n\n        this.pageNode = document.createElement('div');\n        this.pageNode.classList.add('page');\n\n        this.contentNode = document.createElement('section');\n        this.contentNode.classList.add('main');\n\n        this.pageNode.appendChild(this.contentNode);\n\n        this.rootNode.appendChild(this.pageNode);\n    }\n\n    /**\n     * Монтирует элемент.\n     * - Без key: перерисовка контента\n     * - С key: монтирование/замена элемента в конкретном слоте key.\n     */\n    public mount(child: HTMLElement, key?: MountKey): void {\n        if (!key) {\n            this.contentNode.replaceChildren(child);\n            this.childrenByKey.clear();\n\n            return;\n        }\n\n        const existing = this.childrenByKey.get(key);\n\n        if (existing) {\n            existing.remove();\n            this.childrenByKey.delete(key);\n        }\n\n        child.dataset.key = key;\n\n        this.childrenByKey.set(key, child);\n        this.contentNode.appendChild(child);\n    }\n\n    /**\n     * Размонтирует элемент\n     * - Без key: полностью очищает\n     * - С key: удаляет только связанный с key узел\n     */\n    public unmount(key?: MountKey): boolean {\n        if (!key) {\n            const hadAny = this.contentNode.childNodes.length > 0;\n\n            this.contentNode.replaceChildren();\n            this.childrenByKey.clear();\n\n            return hadAny;\n        }\n\n        const el = this.childrenByKey.get(key);\n\n        if (!el) {\n            return false;\n        }\n\n        el.remove();\n\n        this.childrenByKey.delete(key);\n\n        return true;\n    }\n\n    /**\n     * Append без ключа\n     */\n    public addChild(child: HTMLElement): void {\n        this.contentNode.appendChild(child);\n    }\n\n    /**\n     * Добавляет элемент с ключом\n     * @returns функция, которая удалит этот элемент по ключу\n     */\n    public addChildWithKey(key: MountKey, child: HTMLElement): () => boolean {\n        this.mount(child, key);\n\n        return () => this.unmount(key);\n    }\n\n    public hasKey(key: MountKey): boolean {\n        return this.childrenByKey.has(key);\n    }\n}\n","import { App } from './app/app.ts';\nimport { AppStore } from './app/appStore.ts';\nimport { Router } from './app/route.ts';\nimport { MainScreen, WelcomeScreen } from './app/screen-adapters.ts';\nimport { IScreen } from './app/types.ts';\nimport { SYSTEM_NAME_SPACE } from './constant.ts';\nimport { EventEmitter } from './events/events.ts';\nimport { AccountModel } from './models/account/account.ts';\nimport { BalanceModel } from './models/balance/balance.ts';\nimport { TransactionModel } from './models/transaction/transaction.ts';\nimport { BalancePresenter } from './presenters/balancePresenter.ts';\nimport { DayLimitPresenter } from './presenters/dayLimitPresenter.ts';\nimport { TransactionPresenter } from './presenters/transactionPresenter.ts';\nimport { WelcomePagePresenter } from './presenters/welcomePagePresenter.ts';\nimport { transactionDBPromise } from './utils/db/transactionDB.ts';\nimport { MainView } from './views/mainView.ts';\n\n/**\n * Инициализация приложения (Composition Root).\n * - Дожидается готовности IndexedDB\n * - Создаёт зависимости (Events, Models, View, Presenters)\n * - Собирает Screens/Router/App и запускает приложение\n */\nexport async function initApp(): Promise<void> {\n    await transactionDBPromise;\n\n    // Базовые зависимости\n    const events = new EventEmitter();\n\n    // Models\n    const balanceModel = new BalanceModel();\n    const transactionModel = new TransactionModel();\n    const accountModel = new AccountModel(events, balanceModel, transactionModel);\n\n    // Root View\n    const mainView = new MainView();\n\n    // Presenters\n    const welcomePagePresenter = new WelcomePagePresenter(accountModel, mainView, events);\n    const balancePresenter = new BalancePresenter(accountModel, mainView, events);\n    const dayLimitPresenter = new DayLimitPresenter(accountModel, mainView, events);\n    const transactionPresenter = new TransactionPresenter(accountModel, mainView, events);\n\n    const mainScreen = new MainScreen(balancePresenter, dayLimitPresenter, transactionPresenter);\n\n    // Screens\n    const screens: Record<string, IScreen> = {\n        [SYSTEM_NAME_SPACE.WELCOME_PAGE]: new WelcomeScreen(welcomePagePresenter),\n        [SYSTEM_NAME_SPACE.MAIN_PAGE]: mainScreen,\n        [SYSTEM_NAME_SPACE.BALANCE_PAGE]: mainScreen,\n        [SYSTEM_NAME_SPACE.TRANSACTION_PAGE]: mainScreen,\n    };\n\n    // Router + Store + App\n    const router = new Router(screens);\n    const store = new AppStore(events, balanceModel, transactionModel);\n    const app = new App(store, router, events);\n\n    // Старт\n    await app.start();\n}\n\ndocument.addEventListener('DOMContentLoaded', async () => {\n    await initApp();\n});\n"],"names":["balanceDBVersion","balanceDBName","balanceTableName","transactionDBVersion","transactionDBName","transactionTableName","SYSTEM_NAME_SPACE","SYSTEM_EVENTS","LS_NAME_SPACE","App","store","router","events","obj","getCurrentDate","d","getNextDay","today","getNextWeek","getNextTwoWeek","getNextMonth","getLastDayOfCurrentMonth","differentDateInDay","date1","date2","urlAlphabet","nanoid","size","id","bytes","scopedUrlAlphabet","instanceOfAny","object","constructors","c","idbProxyableTypes","cursorAdvanceMethods","getIdbProxyableTypes","getCursorAdvanceMethods","transactionDoneMap","transformCache","reverseTransformCache","promisifyRequest","request","promise","resolve","reject","unlisten","success","error","wrap","cacheDonePromiseForTransaction","tx","done","complete","idbProxyTraps","target","prop","receiver","value","replaceTraps","callback","wrapFunction","func","args","unwrap","transformCachableValue","newValue","openDB","name","version","blocked","upgrade","blocking","terminated","openPromise","event","db","readMethods","writeMethods","cachedMethods","getMethod","targetFuncName","useIndex","isWrite","method","storeName","oldTraps","advanceMethodProps","methodMap","advanceResults","ittrProxiedCursorToOriginalProxy","cursorIteratorTraps","cachedFunc","iterate","cursor","proxiedCursor","isIteratorProp","IndexedDBService","#db","onUpgrade","oldVersion","newVersion","key","#ensureDb","balanceDBPromise","saveBalance","record","balance","getBalance","getAllBalances","transactionDBPromise","saveTransaction","transaction","getTransaction","getAllTransactions","AppStore","balanceModel","transactionModel","transactions","err","balances","newBalance","Router","screens","next","WelcomeScreen","welcomePagePresenter","MainScreen","balancePresenter","dayLimitPresenter","transactionPresenter","page","EventEmitter","eventName","data","subscribers","context","AccountModel","date","currentBalance","diffDays","startBalance","endDate","createDataTransaction","transactionId","wasted","transactionsCount","BalanceModel","TransactionModel","a","b","dateFormatter","dateFullFormatter","Selector","selector","legend","input","hiddenInput","button","img","dropdown","opt","item","evt","el","Calendar","dateSelector","label","parsed","calendar","getMenuItem","span1","span2","option","nextSvg","prevDisabledSvg","prevSvg","DateSelector","nextSelected","year","month","day","lastDayOfMonth","safeDay","currentMonthStart","prevMonthStart","disabled","prevImg","weeks","week","firstDay","lastDay","startDay","i","calendarTitle","spanTitle1","spanTitle2","mountsData","newDatePicker","currentYear","currentMount","datePicker","weekNode","dayName","dayNode","calendarBody","prev","nextImg","onlyNumbersFormatter","currencyFormatterEvent","currencyFormatter","numberFormatter","reg","BalancePresenter","accountModel","view","cardBlock","cardDescription","cardDescSpan1","cardDescSpan2","cardBody","balanceBlock","differentDayToEnd","balanceBlockSpan1","balanceBlockSpan2","balanceChangeButton","form","balanceLabel","balanceTitle","balanceInput","upBalanceLabel","upBalanceTitle","upBalanceInput","calendarObj","calcButton","upBalance","term","balanceNode","dayLimitNode","DayLimitPresenter","balanceBlockH1","wastedComment","newTransaction","balanceBlockWaste","balanceBlockAviable","remainedBalanceDay","commentBlock","TransactionPresenter","cardDescSpan","cardAvgWastedSpan","transactionsList","viewHistoryButton","moveToMainPageButton","fullLoad","transactionsListNode","transactionCard","transactionCardTitle","transactionCardValue","WelcomePagePresenter","title","body","MainView","child","existing","hadAny","initApp","mainView","mainScreen"],"mappings":"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","x_google_ignoreList":[3,4,5]}